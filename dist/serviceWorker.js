(()=>{"use strict";var t={776:(t,e,r)=>{r.d(e,{G:()=>s});var o,n=r(199),i=r(219),c=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(){return t.call(this,"Robinhood","https://robinhood.com")||this}return c(e,t),e.prototype.createUrlForTicker=function(t){return"crypto"===t.tickerType.value?"".concat(this.baseUrl,"/").concat(t.tickerType.value,"/").concat(t.symbol):"".concat(this.baseUrl,"/stocks/").concat(t.symbol)},e.prototype.getTicker=function(t,e){return new i.v(this.getTickerFromUrl(t),this.getName(e),this.getTickerType(this,t,e))},e.prototype.getTickerFromUrl=function(t){var e=t.split("/"),r=e.length-1,o=e[r];return 0===o.trim().length&&(o=e[r-1]),o},e.prototype.getName=function(t){return t.querySelector("main h1").textContent.trim()},e.prototype.isCrypto=function(t){return t.includes("crypto")},e.prototype.isEtf=function(t){return!(null===t.querySelector("#etf-category"))},e.prototype.isNoResultsPage=function(t){return t.querySelector("html title").textContent.includes("Page not found")},e.prototype.isTickerUrl=function(t){return t.startsWith("https://robinhood.com/stocks/")||t.startsWith("https://robinhood.com/crypto/")},e}(n.T)},199:(t,e,r)=>{r.d(e,{T:()=>n});var o=r(110),n=function(){function t(t,e){this.EXCEPTION_TICKERS=new Map,this.name=t,this.baseUrl=e}return t.prototype.is=function(){return this.name},t.prototype.createUrlForTicker=function(t){},t.prototype.getTicker=function(t,e){},t.prototype.getTickerType=function(t,e,r){return t.isEtf(r)?new o.C("etf"):t.isCrypto(e)?new o.C("crypto"):new o.C("stock")},t.prototype.getName=function(t){},t.prototype.isCrypto=function(t){},t.prototype.isEtf=function(t){},t.prototype.isNoResultsPage=function(t){},t.prototype.isTickerUrl=function(t){},t}()},455:(t,e,r)=>{r.d(e,{k:()=>u});var o,n=r(199),i=r(219),c=r(700),s=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(){var e=t.call(this,"YahooFinance","https://finance.yahoo.com")||this;return e.EXCEPTION_TICKERS.set(["GRT6719","crypto"],["GRT","crypto"]),e}return s(e,t),e.prototype.createUrlForTicker=function(t){var e=t.convertPeriodToHyphen(t.symbol);return e=this.checkExceptionList(e,t.tickerType.toString(),!1),"crypto"===t.tickerType.value&&(e+="-USD"),"".concat(this.baseUrl,"/quote/").concat(e)},e.prototype.getTicker=function(t,e){var r=this.getTickerFromPage(e,this.isCrypto(e)),o=this.getTickerType(this,e,e);return new i.v(this.checkExceptionList(r,o.toString(),!0),this.getName(e),o)},e.prototype.checkExceptionList=function(t,e,r){var o,n,i=[t,e],c=this.EXCEPTION_TICKERS.entries();try{for(var s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(c),u=s.next();!u.done;u=s.next()){var a=u.value,p=void 0,l=void 0;if(r?(p=a[0],l=a[1]):(p=a[1],l=a[0]),i[0]===p[0]&&i[1]===p[1]){t=l[0];break}}}catch(t){o={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return t},e.prototype.getQuoteHeaderInfoId=function(){return"#quote-header-info"},e.prototype.getName=function(t){var e=this.getCompanyHeader(t).split(" (")[0];return(new c.c).removeExtraWhitespace(e)},e.prototype.getTickerFromPage=function(t,e){var r=this.getCompanyHeader(t).split(" (")[1];return r=r.split(")")[0],e&&(r=r.split("-")[0]),r},e.prototype.getCompanyHeader=function(t){return t.querySelector(this.getQuoteHeaderInfoId()+" h1").textContent.trim()},e.prototype.isCrypto=function(t){return t.querySelector(this.getQuoteHeaderInfoId()).textContent.includes("CoinMarketCap")},e.prototype.isEtf=function(t){var e=t.querySelector("#quote-summary");return(new c.c).removeExtraWhitespace(e.textContent).includes("Net Assets")},e.prototype.isNoResultsPage=function(t){return!!t.getElementById("lookup-page")},e.prototype.isTickerUrl=function(t){return t.startsWith("https://finance.yahoo.com/quote/")},e}(n.T)},219:(t,e,r)=>{r.d(e,{v:()=>n});var o=r(700),n=function(){function t(t,e,r){this.symbol=this.convertHyphenToPeriod(t);var n=new o.c;this.name=n.removeExtraWhitespace(e),this.tickerType=r}return t.prototype.convertHyphenToPeriod=function(t){return t.replace("-",".")},t.prototype.convertPeriodToHyphen=function(t){return t.replace(".","-")},t.prototype.toString=function(){return"Ticker - symbol: ".concat(this.symbol,", name: ").concat(this.name,", type: ").concat(this.tickerType)},t.prototype.equals=function(t){return this.symbol===t.symbol&&this.nameEquals(t.name)&&this.tickerType.equals(t.tickerType)},t.prototype.nameEquals=function(t){var e=this.name.toLowerCase();return t=t.toLowerCase(),e.includes(t)||t.includes(e)},t}()},110:(t,e,r)=>{r.d(e,{C:()=>o});var o=function(){function t(t){if(this.VALID_TYPES=["stock","etf","mutualfund","crypto","future","bond"],t=t.toLowerCase().trim(),!this.isValidType(t))throw new Error("Invalid tickerType: "+t);this.value=t}return t.prototype.isValidType=function(t){return this.VALID_TYPES.includes(t)},t.prototype.toString=function(){return this.value},t.prototype.equals=function(t){return this.value===t.value},t}()},700:(t,e,r)=>{r.d(e,{c:()=>o});var o=function(){function t(){}return t.prototype.removeExtraWhitespace=function(t){var e=new RegExp("\\s+"),r=t.split(e),o="";return r.forEach((function(t){o=o+t.trim()+" "})),o.trim()},t}()}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,r),i.exports}r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=r(455),e=r(110),o=r(219),n=r(776);function i(e){return console.log("determineSite(site): "+e),(e=e.toLowerCase()).includes("robinhood")?new n.G:new t.k}chrome.action.onClicked.addListener((function(t){chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){var r=e[0],o=r.index;chrome.tabs.sendMessage(r.id,{message:"clicked_browser_action",url:t.url,index:o+1})}))})),chrome.runtime.onMessage.addListener((function(t,r,n){if("open_new_tab"===t.message){var c=i(t.toSite),s=new o.v(t.tickerSymbol,t.tickerName,new e.C(t.tickerType));console.log("serviceWorker ticker: "+s.toString());var u=c.createUrlForTicker(s);chrome.tabs.create({url:u,index:t.index})}})),chrome.runtime.onMessage.addListener((function(t,e,r){if("open_homepage"===t.message){var o=i(t.toSite).baseUrl;console.log("serviceWorker open_homepage url: "+o),chrome.tabs.create({url:o,index:t.index})}}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLG9DQUFzQzFGLEdBRWxEMkYsT0FBT0ssS0FBS2tCLE9BQU8sQ0FDZmxILElBQUtBLEVBQ0xxRyxNQUFPTSxFQUFRTixPLENBRzNCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy9zaXRlcy9Sb2Jpbmhvb2QudHMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvc2l0ZXMvU2l0ZS50cyIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy9zaXRlcy9ZYWhvb0ZpbmFuY2UudHMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvdGlja2Vycy9UaWNrZXIudHMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvdGlja2Vycy9UaWNrZXJUeXBlLnRzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlLy4vc3JjL3V0aWxzL1V0aWxzLnRzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlLy4vc3JjL3NlcnZpY2VXb3JrZXJzL3NlcnZpY2VXb3JrZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2l0ZSB9IGZyb20gXCIuL1NpdGVcIjtcbmltcG9ydCB7IFRpY2tlclR5cGUgfSBmcm9tIFwiLi4vdGlja2Vycy9UaWNrZXJUeXBlXCI7XG5pbXBvcnQgeyBUaWNrZXIgfSBmcm9tIFwiLi4vdGlja2Vycy9UaWNrZXJcIjtcblxuZXhwb3J0IGNsYXNzIFJvYmluaG9vZCBleHRlbmRzIFNpdGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcIlJvYmluaG9vZFwiLCBgaHR0cHM6Ly9yb2Jpbmhvb2QuY29tYCk7XG4gICAgfVxuXG4gICAgY3JlYXRlVXJsRm9yVGlja2VyKHRpY2tlcjogVGlja2VyKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHRpY2tlci50aWNrZXJUeXBlLnZhbHVlID09PSBcImNyeXB0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5iYXNlVXJsfS8ke3RpY2tlci50aWNrZXJUeXBlLnZhbHVlfS8ke3RpY2tlci5zeW1ib2x9YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEVURnMgYWxzbyBnZXQgdGhlICdzdG9ja3MnIHBhdGggaW4gdGhlIHVybCBvbiBSSFxuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMuYmFzZVVybH0vc3RvY2tzLyR7dGlja2VyLnN5bWJvbH1gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0VGlja2VyKHVybDogc3RyaW5nLCBkb2N1bWVudDogRG9jdW1lbnQpOiBUaWNrZXIge1xuICAgICAgICByZXR1cm4gbmV3IFRpY2tlcihcbiAgICAgICAgICAgIHRoaXMuZ2V0VGlja2VyRnJvbVVybCh1cmwpLFxuICAgICAgICAgICAgdGhpcy5nZXROYW1lKGRvY3VtZW50KSxcbiAgICAgICAgICAgIHRoaXMuZ2V0VGlja2VyVHlwZSh0aGlzLCB1cmwsIGRvY3VtZW50KVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB1cmwgLSB0aGlzIHBhZ2UncyB1cmxcbiAgICAgKiBAcmV0dXJucyBqdXN0IHRoZSB0aWNrZXIgc2VjdGlvbiBvZiB0aGUgZ2l2ZW4gdXJsXG4gICAgICovXG4gICAgZ2V0VGlja2VyRnJvbVVybCh1cmw6IHN0cmluZykge1xuICAgICAgICBsZXQgc3BsaXRBcnJheSA9IHVybC5zcGxpdChcIi9cIik7XG5cbiAgICAgICAgbGV0IGxhc3RJbmRleCA9IHNwbGl0QXJyYXkubGVuZ3RoIC0gMTtcbiAgICAgICAgbGV0IHRpY2tlciA9IHNwbGl0QXJyYXlbbGFzdEluZGV4XTtcbiAgICAgICAgaWYgKHRpY2tlci50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aWNrZXIgPSBzcGxpdEFycmF5W2xhc3RJbmRleCAtIDFdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRpY2tlcjtcbiAgICB9XG5cbiAgICBnZXROYW1lKGRvY3VtZW50OiBEb2N1bWVudCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpbiBoMVwiKS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgfVxuXG4gICAgaXNDcnlwdG8odXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHVybC5pbmNsdWRlcyhcImNyeXB0b1wiKTtcbiAgICB9XG5cbiAgICBpc0V0Zihkb2N1bWVudDogRG9jdW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGV0ZkNhdGVnb3J5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNldGYtY2F0ZWdvcnlcIik7XG4gICAgICAgIHJldHVybiAhKGV0ZkNhdGVnb3J5ID09PSBudWxsKTtcbiAgICB9XG5cbiAgICBpc05vUmVzdWx0c1BhZ2UoZG9jdW1lbnQ6IERvY3VtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCJodG1sIHRpdGxlXCIpXG4gICAgICAgICAgICAudGV4dENvbnRlbnQuaW5jbHVkZXMoXCJQYWdlIG5vdCBmb3VuZFwiKTtcbiAgICB9XG5cbiAgICBpc1RpY2tlclVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgdXJsLnN0YXJ0c1dpdGgoXCJodHRwczovL3JvYmluaG9vZC5jb20vc3RvY2tzL1wiKSB8fFxuICAgICAgICAgICAgdXJsLnN0YXJ0c1dpdGgoXCJodHRwczovL3JvYmluaG9vZC5jb20vY3J5cHRvL1wiKVxuICAgICAgICApO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRpY2tlciB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclwiO1xuaW1wb3J0IHsgVGlja2VyVHlwZSB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclR5cGVcIjtcblxuLyoqXG4gKiBQYXJlbnQgY2xhc3MgZm9yIG9iamVjdHMgaG9sZGluZyBpbmZvcm1hdGlvblxuICogYWJvdXQgYSBwYXJ0aWN1bGFyIHdlYnNpdGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBTaXRlIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYmFzZVVybDogc3RyaW5nO1xuICAgIEVYQ0VQVElPTl9USUNLRVJTOiBNYXA8YW55LCBhbnk+ID0gbmV3IE1hcCgpO1xuXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBiYXNlVXJsOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgbmFtZSBvZiB0aGUgc2l0ZVxuICAgICAqL1xuICAgIGlzKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBUaWNrZXIsIGNyZWF0ZSB0aGUgYXBwcm9wcmlhdGUgdXJsIGZvciB0aGF0IFRpY2tlclxuICAgICAqIG9uIHRoaXMgU2l0ZS5cbiAgICAgKiBAcGFyYW0gdGlja2VyIC0gdGhlIFRpY2tlciBmb3Igd2hpY2ggd2UncmUgY3JlYXRpbmcgYSB1cmxcbiAgICAgKi9cbiAgICBjcmVhdGVVcmxGb3JUaWNrZXIodGlja2VyOiBUaWNrZXIpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIFB1bGwgYWxsIG5lY2Vzc2FyeSBpbmZvcm1hdGlvbiBmcm9tIHRoZSBjdXJyZW50IHVybFxuICAgICAqIGFuZCBwYWdlIHRvIGNyZWF0ZSBhIFRpY2tlciBvYmplY3QgdG8gc2VuZCB0byBvdGhlciBTaXRlc1xuICAgICAqIEBwYXJhbSB1cmwgLSB1cmwgb2YgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIERPTSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICovXG4gICAgZ2V0VGlja2VyKHVybDogc3RyaW5nLCBkb2N1bWVudDogRG9jdW1lbnQpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZSB0aGUgdHlwZSBvZiB0aWNrZXIgZm9yIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKiAoc3RvY2ssIGNyeXB0bywgZXRjKVxuICAgICAqIEBwYXJhbSBzaXRlIC0gdGhlIFNpdGUgd2hpY2ggdGhlIHVzZXIgaXMgY3VycmVudGx5IG9uXG4gICAgICogQHBhcmFtIGNyeXB0b0FyZyAtIHNvbWUgc2l0ZXMgbWF5IG5lZWQgYSBzZXBhcmF0ZSB3YXkgdG8gaWRlbnRpZnkgd2hldGhlciBvciBub3QgdGhlIHBhZ2UgaXMgYSBjcnlwdG8gcGFnZSAoc3VjaCBhcyB0aGUgdXJsKS5cbiAgICAgKiBJZiB0aGF0J3MgdGhlIGNhc2UsIHRoYXQgYXJnIGdvZXMgaGVyZS4gT3RoZXJ3aXNlLCB0aGUgRG9jdW1lbnQgcGFyYW0gaXMgdXN1YWxseSBzZW50IHR3aWNlLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIHRoZSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZSwgYXMgYSBEb2N1bWVudCBvYmplY3QuXG4gICAgICogQHJldHVybnMgVGlja2VyVHlwZSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICovXG4gICAgZ2V0VGlja2VyVHlwZShzaXRlOiBTaXRlLCBjcnlwdG9Bcmc6IGFueSwgZG9jdW1lbnQ6IERvY3VtZW50KTogVGlja2VyVHlwZSB7XG4gICAgICAgIGlmIChzaXRlLmlzRXRmKGRvY3VtZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXJUeXBlKFwiZXRmXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpdGUuaXNDcnlwdG8oY3J5cHRvQXJnKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXJUeXBlKFwiY3J5cHRvXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXJUeXBlKFwic3RvY2tcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdHlwZSBmb3IgdGhlIG1ldGhvZHMgYmVsb3cgaXMgXCJhbnlcIiwgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHJldHVybiBhIHZhbHVlIGluIHRoZSBzdXBlcmNsYXNzLCB3aGljaCB3ZSB3b3VsZCBoYXZlIHRvIHNpbmNlIHdlJ3JlIHVzaW5nIHRoZW0gaW4gZ2V0VGlja2VyVHlwZSBhYm92ZS5cbiAgICAvLyBJbXBsZW1lbnRhdGlvbnMgb2YgdGhlc2UgbWV0aG9kcyBpbiBzdWJjbGFzc2VzIHNob3VsZCByZXR1cm4gYSBib29sZWFuLlxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjb21wYW55J3MgZnVsbCBuYW1lXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gRE9NIGNvbnRlbnQgb2YgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqL1xuICAgIGdldE5hbWUoZG9jdW1lbnQ6IERvY3VtZW50KTogYW55IHt9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGN1cnJlbnQgcGFnZSBpcyBmb3IgYSBjcnlwdG9jdXJyZW5jeSxcbiAgICAgKiBmYWxzZSBvdGhlcndpc2UuXG4gICAgICogQHBhcmFtIHggLSBhcmcgb2YgYW55IHR5cGUgd2hpY2ggd2lsbCBoZWxwIGEgcGFydGl1bGFyIHNpdGVcbiAgICAgKiBpZGVudGlmeSBhIGNyeXB0b2N1cnJlbmN5IHBhZ2UuXG4gICAgICovXG4gICAgaXNDcnlwdG8oeDogYW55KTogYW55IHt9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGN1cnJlbnQgcGFnZSBpcyBmb3IgYW4gRVRGLFxuICAgICAqIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZS5cbiAgICAgKi9cbiAgICBpc0V0Zihkb2N1bWVudDogRG9jdW1lbnQpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY3VycmVudCBwYWdlIGlzIGEgTm8gUmVzdWx0cyBwYWdlLFxuICAgICAqIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZS5cbiAgICAgKi9cbiAgICBpc05vUmVzdWx0c1BhZ2UoZG9jdW1lbnQ6IERvY3VtZW50KTogYW55IHt9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gdXJsIC0gdGhlIGN1cnJlbnQgcGFnZSdzIHVybFxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHVybCBpbmRpY2F0ZXMgdGhhdCB0aGUgcGFnZSBpcyBmb3Igb25lIHNwZWNpZmljIFRpY2tlcixcbiAgICAgKiBmYWxzZSBpZiBpdCdzIGFueSBvdGhlciBraW5kIG9mIHBhZ2UuXG4gICAgICovXG4gICAgaXNUaWNrZXJVcmwodXJsOiBzdHJpbmcpOiBhbnkge31cbn1cbiIsImltcG9ydCB7IFNpdGUgfSBmcm9tIFwiLi9TaXRlXCI7XG5pbXBvcnQgeyBUaWNrZXJUeXBlIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyVHlwZVwiO1xuaW1wb3J0IHsgVGlja2VyIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyXCI7XG5pbXBvcnQgeyBVdGlscyB9IGZyb20gXCIuLi91dGlscy9VdGlsc1wiO1xuXG5leHBvcnQgY2xhc3MgWWFob29GaW5hbmNlIGV4dGVuZHMgU2l0ZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiWWFob29GaW5hbmNlXCIsIGBodHRwczovL2ZpbmFuY2UueWFob28uY29tYCk7XG5cbiAgICAgICAgdGhpcy5FWENFUFRJT05fVElDS0VSUy5zZXQoW1wiR1JUNjcxOVwiLCBcImNyeXB0b1wiXSwgW1wiR1JUXCIsIFwiY3J5cHRvXCJdKTtcbiAgICB9XG5cbiAgICBjcmVhdGVVcmxGb3JUaWNrZXIodGlja2VyOiBUaWNrZXIpOiBzdHJpbmcge1xuICAgICAgICBsZXQgczogc3RyaW5nID0gdGlja2VyLmNvbnZlcnRQZXJpb2RUb0h5cGhlbih0aWNrZXIuc3ltYm9sKTtcblxuICAgICAgICBzID0gdGhpcy5jaGVja0V4Y2VwdGlvbkxpc3QocywgdGlja2VyLnRpY2tlclR5cGUudG9TdHJpbmcoKSwgZmFsc2UpO1xuXG4gICAgICAgIC8vIElmIHRoZSBwYWdlIHRoYXQgd2UncmUgb24gaXMgZm9yIGEgc3RvY2sgb3IgRVRGLCB0aGVuIHdlIGNhbiBqdXN0IGxlYXZlIHRoZSB0aWNrZXIgYXMtaXMuXG4gICAgICAgIC8vIElmIHRoZSBwYWdlIHRoYXQgd2UncmUgb24gaXMgZm9yIGEgY3J5cHRvY3VycmVuY3ksIHRoZW4gd2UgbmVlZFxuICAgICAgICAvLyB0byBhZGp1c3QgdGhlIHRpY2tlciB0byBhZGQgdGhlIFwicXVvdGUgY3VycmVuY3lcIiAtLVxuICAgICAgICAvLyB0aGUgY3VycmVuY3kgZm9yIHdoaWNoIHdlJ3JlIGRpc3BsYXlpbmcgdGhlIGV4Y2hhbmdlIHJhdGUgdG8gdGhlIGNyeXB0b2N1cnJlbmN5LlxuICAgICAgICAvLyBCeSBkZWZhdWx0LCB3ZSdsbCB1c2UgdGhlIFVTIERvbGxhciAoXCJVU0RcIikuXG4gICAgICAgIC8vIFRPRE86IEFsbG93IHVzZXIgdG8gc2VsZWN0IHRoZWlyIHByZWZlcnJlZCBxdW90ZSBjdXJyZW5jeSBpbiBPcHRpb25zIG1lbnUuXG4gICAgICAgIGlmICh0aWNrZXIudGlja2VyVHlwZS52YWx1ZSA9PT0gXCJjcnlwdG9cIikge1xuICAgICAgICAgICAgcyA9IHMgKyBgLVVTRGA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuYmFzZVVybH0vcXVvdGUvJHtzfWA7XG4gICAgfVxuXG4gICAgZ2V0VGlja2VyKHVybDogc3RyaW5nLCBkb2N1bWVudDogRG9jdW1lbnQpOiBUaWNrZXIge1xuICAgICAgICBsZXQgdGlja2VyU3RyaW5nOiBzdHJpbmcgPSB0aGlzLmdldFRpY2tlckZyb21QYWdlKFxuICAgICAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgICAgICB0aGlzLmlzQ3J5cHRvKGRvY3VtZW50KVxuICAgICAgICApO1xuICAgICAgICBsZXQgdGlja2VyVHlwZTogVGlja2VyVHlwZSA9IHRoaXMuZ2V0VGlja2VyVHlwZShcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgICAgIGRvY3VtZW50XG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXIoXG4gICAgICAgICAgICB0aGlzLmNoZWNrRXhjZXB0aW9uTGlzdCh0aWNrZXJTdHJpbmcsIHRpY2tlclR5cGUudG9TdHJpbmcoKSwgdHJ1ZSksXG4gICAgICAgICAgICB0aGlzLmdldE5hbWUoZG9jdW1lbnQpLFxuICAgICAgICAgICAgdGlja2VyVHlwZVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZXJlIGFyZSBhIGZldyBvdXRsaWVyIHNlY3VyaXRpZXMgd2hpY2ggZG8gbm90IGFiaWRlIGJ5IHRoZSB1cmwgY3JlYXRpb25cbiAgICAgKiBydWxlcyB3aGljaCBhcmUgbm9ybWFsbHkgdXNlZCBvbiBjZXJ0YWluIHNpdGVzLiBUbyBoYW5kbGUgdGhlc2UgY2FzZXMsIHdlIG5lZWQgdG9cbiAgICAgKiBjaGVjayB0byBzZWUgaWYgb3VyIHRpY2tlciBmYWxscyBpbnRvIHRoaXMgc21hbGwgc2V0IG9mIGV4Y2VwdGlvbnMsXG4gICAgICogYW5kIGlmIHNvLCB0byBjb252ZXJ0IGl0IHRvIHRoZSBjb3JyZWN0IHRpY2tlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aWNrZXJTdHIgLSB0aGUgdGlja2VyIHdoaWNoIHdlJ3JlIGNoZWNraW5nIHRvIHNlZSBpZiBpdCdzIG9uIHRoZSBleGNlcHRpb24gbGlzdFxuICAgICAqIEBwYXJhbSB0dFN0ciAtIHRoZSB0aWNrZXIgdHlwZSBvZiB0aGUgZ2l2ZW4gdGlja2VyXG4gICAgICogQHBhcmFtIGlzT3V0Z29pbmcgLSB0cnVlIGlmIHdlJ3JlIGNvbnZlcnRpbmcgdGhlIHRpY2tlciB0b1xuICAgICAqIHVzZSBpdCBmb3IgYSBkaWZmZXJlbnQgc2l0ZSwgZmFsc2UgaWYgdGhpcyBpcyBhbiBpbmNvbWluZyB0aWNrZXJcbiAgICAgKiB3aGljaCB3ZSdyZSBjb252ZXJ0aW5nIGZvciB1c2Ugb24gKnRoaXMqIHNpdGUuXG4gICAgICogQHJldHVybnMgdGhlIGNvcnJlY3QgdGlja2VyIHN0cmluZywgd2hldGhlciBpdCBuZWVkZWQgdG8gYmUgYWRqdXN0ZWQgb3Igbm90LlxuICAgICAqL1xuICAgIGNoZWNrRXhjZXB0aW9uTGlzdChcbiAgICAgICAgdGlja2VyU3RyOiBzdHJpbmcsXG4gICAgICAgIHR0U3RyOiBzdHJpbmcsXG4gICAgICAgIGlzT3V0Z29pbmc6IGJvb2xlYW5cbiAgICApOiBzdHJpbmcge1xuICAgICAgICBsZXQgYXJnQXJyYXkgPSBbdGlja2VyU3RyLCB0dFN0cl07XG4gICAgICAgIGxldCBleGNlcHRpb25JdGVyYXRvciA9IHRoaXMuRVhDRVBUSU9OX1RJQ0tFUlMuZW50cmllcygpO1xuICAgICAgICBmb3IgKGxldCBwYWlyIG9mIGV4Y2VwdGlvbkl0ZXJhdG9yKSB7XG4gICAgICAgICAgICBsZXQga2V5QXJyYXk7XG4gICAgICAgICAgICBsZXQgdmFsQXJyYXk7XG4gICAgICAgICAgICBpZiAoaXNPdXRnb2luZykge1xuICAgICAgICAgICAgICAgIGtleUFycmF5ID0gcGFpclswXTtcbiAgICAgICAgICAgICAgICB2YWxBcnJheSA9IHBhaXJbMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGtleUFycmF5ID0gcGFpclsxXTtcbiAgICAgICAgICAgICAgICB2YWxBcnJheSA9IHBhaXJbMF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhcmdBcnJheVswXSA9PT0ga2V5QXJyYXlbMF0gJiYgYXJnQXJyYXlbMV0gPT09IGtleUFycmF5WzFdKSB7XG4gICAgICAgICAgICAgICAgdGlja2VyU3RyID0gdmFsQXJyYXlbMF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGlja2VyU3RyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIGlkIGZvciB0aGUgcXVvdGUgaGVhZGVyIGVsZW1lbnRcbiAgICAgKi9cbiAgICBnZXRRdW90ZUhlYWRlckluZm9JZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCIjcXVvdGUtaGVhZGVyLWluZm9cIjtcbiAgICB9XG5cbiAgICBnZXROYW1lKGRvY3VtZW50OiBEb2N1bWVudCk6IHN0cmluZyB7XG4gICAgICAgIGxldCBuYW1lID0gdGhpcy5nZXRDb21wYW55SGVhZGVyKGRvY3VtZW50KTtcbiAgICAgICAgbGV0IG5hbWVXaXRoVGlja2VyUmVtb3ZlZCA9IG5hbWUuc3BsaXQoXCIgKFwiKVswXTtcbiAgICAgICAgbGV0IHV0aWxzID0gbmV3IFV0aWxzKCk7XG4gICAgICAgIHJldHVybiB1dGlscy5yZW1vdmVFeHRyYVdoaXRlc3BhY2UobmFtZVdpdGhUaWNrZXJSZW1vdmVkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIHRoZSB0aWNrZXIgc3ltYm9sIGluIHRoZSBwYWdlLCBhbmQgc2VwYXJhdGUgaXQgZnJvbSBhbnkgdW5uZWNlc3NhcnkgdGV4dFxuICAgICAqIHdoaWNoIHN1cnJvdW5kcyBpdC5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqIEBwYXJhbSBpc0NyeXB0byAtIHRydWUgaWYgdGhlIGN1cnJlbnQgcGFnZSBpcyBmb3IgYSBjcnlwdG9jdXJyZW5jeSxcbiAgICAgKiBmYWxzZSBvdGhlcndpc2VcbiAgICAgKiBAcmV0dXJucyB0aWNrZXIgc3ltYm9sXG4gICAgICovXG4gICAgZ2V0VGlja2VyRnJvbVBhZ2UoZG9jdW1lbnQ6IERvY3VtZW50LCBpc0NyeXB0bzogYm9vbGVhbik6IHN0cmluZyB7XG4gICAgICAgIGxldCBuYW1lID0gdGhpcy5nZXRDb21wYW55SGVhZGVyKGRvY3VtZW50KTtcbiAgICAgICAgbGV0IGNsZWFuZWRVcFN5bWJvbCA9IG5hbWUuc3BsaXQoXCIgKFwiKVsxXTtcbiAgICAgICAgY2xlYW5lZFVwU3ltYm9sID0gY2xlYW5lZFVwU3ltYm9sLnNwbGl0KFwiKVwiKVswXTtcbiAgICAgICAgaWYgKGlzQ3J5cHRvKSB7XG4gICAgICAgICAgICBjbGVhbmVkVXBTeW1ib2wgPSBjbGVhbmVkVXBTeW1ib2wuc3BsaXQoXCItXCIpWzBdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNsZWFuZWRVcFN5bWJvbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqIEByZXR1cm5zIHRleHQgY29udGVudCBvZiB0aGUgY29tcGFueSBoZWFkZXIgZWxlbWVudFxuICAgICAqL1xuICAgIGdldENvbXBhbnlIZWFkZXIoZG9jdW1lbnQ6IERvY3VtZW50KTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLmdldFF1b3RlSGVhZGVySW5mb0lkKCkgKyBcIiBoMVwiKVxuICAgICAgICAgICAgLnRleHRDb250ZW50LnRyaW0oKTtcbiAgICB9XG5cbiAgICBpc0NyeXB0byhkb2N1bWVudDogRG9jdW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHF1b3RlSGVhZGVySW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICB0aGlzLmdldFF1b3RlSGVhZGVySW5mb0lkKClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHF1b3RlSGVhZGVySW5mby50ZXh0Q29udGVudC5pbmNsdWRlcyhcIkNvaW5NYXJrZXRDYXBcIik7XG4gICAgfVxuXG4gICAgaXNFdGYoZG9jdW1lbnQ6IERvY3VtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBxdW90ZVN1bW1hcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3F1b3RlLXN1bW1hcnlcIik7XG4gICAgICAgIGxldCB1dGlscyA9IG5ldyBVdGlscygpO1xuXG4gICAgICAgIGxldCB0ZXh0Q2xlYW5lZFVwID0gdXRpbHMucmVtb3ZlRXh0cmFXaGl0ZXNwYWNlKFxuICAgICAgICAgICAgcXVvdGVTdW1tYXJ5LnRleHRDb250ZW50XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB0ZXh0Q2xlYW5lZFVwLmluY2x1ZGVzKFwiTmV0IEFzc2V0c1wiKTtcbiAgICB9XG5cbiAgICBpc05vUmVzdWx0c1BhZ2UoZG9jdW1lbnQ6IERvY3VtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9va3VwLXBhZ2VcIik7XG4gICAgfVxuXG4gICAgaXNUaWNrZXJVcmwodXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHVybC5zdGFydHNXaXRoKFwiaHR0cHM6Ly9maW5hbmNlLnlhaG9vLmNvbS9xdW90ZS9cIik7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVGlja2VyVHlwZSB9IGZyb20gXCIuL1RpY2tlclR5cGVcIjtcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1V0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBUaWNrZXIge1xuICAgIHN5bWJvbDogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0aWNrZXJUeXBlOiBUaWNrZXJUeXBlO1xuXG4gICAgY29uc3RydWN0b3Ioc3ltYm9sOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgdGlja2VyVHlwZTogVGlja2VyVHlwZSkge1xuICAgICAgICB0aGlzLnN5bWJvbCA9IHRoaXMuY29udmVydEh5cGhlblRvUGVyaW9kKHN5bWJvbCk7XG4gICAgICAgIGxldCB1dGlscyA9IG5ldyBVdGlscygpO1xuICAgICAgICB0aGlzLm5hbWUgPSB1dGlscy5yZW1vdmVFeHRyYVdoaXRlc3BhY2UobmFtZSk7XG4gICAgICAgIHRoaXMudGlja2VyVHlwZSA9IHRpY2tlclR5cGU7XG4gICAgfVxuXG4gICAgY29udmVydEh5cGhlblRvUGVyaW9kKHN5bWJvbDogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiBzeW1ib2wucmVwbGFjZShcIi1cIiwgXCIuXCIpO1xuICAgIH1cblxuICAgIGNvbnZlcnRQZXJpb2RUb0h5cGhlbihzeW1ib2w6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gc3ltYm9sLnJlcGxhY2UoXCIuXCIsIFwiLVwiKTtcbiAgICB9XG5cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFRpY2tlciAtIHN5bWJvbDogJHt0aGlzLnN5bWJvbH0sIG5hbWU6ICR7dGhpcy5uYW1lfSwgdHlwZTogJHt0aGlzLnRpY2tlclR5cGV9YDtcbiAgICB9XG5cbiAgICBlcXVhbHModGhhdDogVGlja2VyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICB0aGlzLnN5bWJvbCA9PT0gdGhhdC5zeW1ib2wgJiZcbiAgICAgICAgICAgIHRoaXMubmFtZUVxdWFscyh0aGF0Lm5hbWUpICYmXG4gICAgICAgICAgICB0aGlzLnRpY2tlclR5cGUuZXF1YWxzKHRoYXQudGlja2VyVHlwZSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayB0byBzZWUgaWYgYSBnaXZlbiBjb21wYW55J3MgbmFtZSBtYXRjaGVzIHRoaXMgY29tcGFueSdzIG5hbWUuXG4gICAgICogU2luY2UgdGhlc2UgdmFsdWVzIGFyZSBiZWluZyBwdWxsZWQgZnJvbSBlYWNoIHNpdGUgd2UncmUgdmlzaXRpbmcgKGFuZCB3ZSBjYW4ndCBjb250cm9sIHdoYXQgdGhleSBjYWxsIHRoZW0pLFxuICAgICAqIGFuZCBzaW5jZSB0aGVzZSBlcXVhbGl0eSBmdW5jdGlvbnMgYXJlIChhdCBsZWFzdCBzbyBmYXIpIG9ubHkgYmVpbmcgdXNlZCB0byBmYWNpbGl0YXRlIHVuaXQgdGVzdGluZyBhbnl3YXksXG4gICAgICogdGhpcyBmdW5jdGlvbiBpcyBiYXNpY2FsbHkganVzdCBjaGVja2luZyB0byBzZWUgaWYgdGhlIG5hbWVzIGFyZSBcImNsb3NlIGVub3VnaFwiIGJ5IGNoZWNraW5nIHRvIHNlZSBpZiBvbmUgc3RyaW5nIGluY2x1ZGVzIHRoZSBvdGhlci5cbiAgICAgKlxuICAgICAqIEZvciBleGFtcGxlLCB0aGUgUkggcGFnZSBmb3IgJFNQWSBjYWxscyBpdCBcIlNQRFIgUyZQIDUwMCBFVEZcIiwgd2hpbGUgWUYgY2FsbHMgaXQgXCJTUERSIFMmUCA1MDAgRVRGIFRydXN0XCIuXG4gICAgICogRXZlbiB0aG91Z2ggdGhlIHN0cmluZ3MgYXJlbid0IGlkZW50aWNhbCwgd2Ugc3RpbGwgd2FudCB0aGVzZSB0byBiZSBjb25zaWRlcmVkIGVxdWFsLCBzbyB3ZSBjYW4ganVzdCBjaGVjayBpZiBvbmUgY29udGFpbnMgdGhlIG90aGVyLCB3aGljaCBpdCBkb2VzLlxuICAgICAqXG4gICAgICogVE9ETyAtIHRoZXJlIHdpbGwgcHJvYmFibHkgYmUgc29tZSBlZGdlIGNhc2VzIGZvciB3aGljaCB0aGlzIHNvbHV0aW9uIHdpbGwgbm90IHdvcmssIHNvIHRoaXMgd2lsbCBsaWtlbHkgaGF2ZSB0byBiZSByZXZpc2VkIGluIHRoZSBmdXR1cmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGhhdE5hbWUgLSBuYW1lIG9mIHRoZSBjb21wYW55IHRvIHdoaWNoIHdlJ3JlIGNvbXBhcmluZyB0aGlzIGNvbXBhbnlcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBjb21wYW5pZXMnIG5hbWVzIGFyZSB0aGUgc2FtZSAob3IgYXQgbGVhc3QsIGNsb3NlIGVub3VnaClcbiAgICAgKi9cbiAgICBuYW1lRXF1YWxzKHRoYXROYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHRoaXNOYW1lID0gdGhpcy5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHRoYXROYW1lID0gdGhhdE5hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICByZXR1cm4gdGhpc05hbWUuaW5jbHVkZXModGhhdE5hbWUpIHx8IHRoYXROYW1lLmluY2x1ZGVzKHRoaXNOYW1lKTtcbiAgICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVGlja2VyVHlwZSB7XG4gICAgVkFMSURfVFlQRVMgPSBbXCJzdG9ja1wiLCBcImV0ZlwiLCBcIm11dHVhbGZ1bmRcIiwgXCJjcnlwdG9cIiwgXCJmdXR1cmVcIiwgXCJib25kXCJdO1xuICAgIHZhbHVlOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3Rvcih0aWNrZXJUeXBlOiBzdHJpbmcpIHtcbiAgICAgICAgdGlja2VyVHlwZSA9IHRpY2tlclR5cGUudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWRUeXBlKHRpY2tlclR5cGUpKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdGlja2VyVHlwZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdGlja2VyVHlwZTogXCIgKyB0aWNrZXJUeXBlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB0dCAtIFRpY2tlclR5cGUgYXMgYSBzdHJpbmdcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBzdHJpbmcgaXMgd2l0aGluXG4gICAgICogdGhlIFZBTElEX1RZUEVTIGxpc3QsIGZhbHNlIG90aGVyd2lzZVxuICAgICAqL1xuICAgIGlzVmFsaWRUeXBlKHR0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVkFMSURfVFlQRVMuaW5jbHVkZXModHQpO1xuICAgIH1cblxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgIH1cblxuICAgIGVxdWFscyh0aGF0OiBUaWNrZXJUeXBlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSB0aGF0LnZhbHVlO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBVdGlscyB7XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBsYXJnZSBjaHVua3Mgb2Ygd2hpdGVzcGFjZSBmcm9tIGEgZ2l2ZW4gc3RyaW5nLFxuICAgICAqIHJlcGxhY2luZyBlYWNoIHdpdGgganVzdCBhIHNpbmdsZSBzcGFjZS5cbiAgICAgKiBAcGFyYW0gc3RyIC0gdGV4dCB3aGljaCBjb250YWlucyBleGNlc3Mgd2hpdGVzcGFjZVxuICAgICAqIEByZXR1cm5zIHN0cmluZyB3aXRoIGV4Y2VzcyB3aGl0ZXNwYWNlIHJlbW92ZWRcbiAgICAgKi9cbiAgICByZW1vdmVFeHRyYVdoaXRlc3BhY2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxcXHMrXCIpO1xuICAgICAgICBsZXQgc3BsaXQgPSBzdHIuc3BsaXQocmVnZXgpO1xuICAgICAgICBsZXQgZnVsbCA9IFwiXCI7XG4gICAgICAgIHNwbGl0LmZvckVhY2goZnVuY3Rpb24gKHdvcmQpIHtcbiAgICAgICAgICAgIGZ1bGwgPSBmdWxsICsgd29yZC50cmltKCkgKyBcIiBcIjtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIEdldCByaWQgb2YgdGhlIG9uZSBleHRyYSBzcGFjZSBhdCB0aGUgZW5kIGJlZm9yZSB3ZSByZXR1cm5cbiAgICAgICAgcmV0dXJuIGZ1bGwudHJpbSgpO1xuICAgIH1cbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiaW1wb3J0IHsgWWFob29GaW5hbmNlIH0gZnJvbSBcIi4uL3NpdGVzL1lhaG9vRmluYW5jZVwiO1xuaW1wb3J0IHsgVGlja2VyVHlwZSB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclR5cGVcIjtcbmltcG9ydCB7IFRpY2tlciB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclwiO1xuaW1wb3J0IHsgUm9iaW5ob29kIH0gZnJvbSBcIi4uL3NpdGVzL1JvYmluaG9vZFwiO1xuaW1wb3J0IHsgU2l0ZSB9IGZyb20gXCIuLi9zaXRlcy9TaXRlXCI7XG5cbi8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyBvbiB0aGUgYnJvd3NlciBhY3Rpb24uXG5jaHJvbWUuYWN0aW9uLm9uQ2xpY2tlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbiBpbmplY3QodGFiKSB7XG4gICAgY2hyb21lLnRhYnMucXVlcnkoXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGxhc3RGb2N1c2VkV2luZG93OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbiAodGFicykge1xuICAgICAgICAgICAgdmFyIGFjdGl2ZVRhYiA9IHRhYnNbMF07XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBhY3RpdmVUYWIuaW5kZXg7XG4gICAgICAgICAgICBjaHJvbWUudGFicy5zZW5kTWVzc2FnZShhY3RpdmVUYWIuaWQsIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcImNsaWNrZWRfYnJvd3Nlcl9hY3Rpb25cIixcbiAgICAgICAgICAgICAgICB1cmw6IHRhYi51cmwsXG4gICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4ICsgMSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgKTtcbn0pO1xuXG4vLyBPcGVuIG5ldyB0YWJcbmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbiBvcGVuTmV3VGFiKFxuICAgIHJlcXVlc3QsXG4gICAgc2VuZGVyLFxuICAgIHNlbmRSZXNwb25zZVxuKSB7XG4gICAgaWYgKHJlcXVlc3QubWVzc2FnZSA9PT0gXCJvcGVuX25ld190YWJcIikge1xuICAgICAgICBsZXQgdG9TaXRlID0gZGV0ZXJtaW5lU2l0ZShyZXF1ZXN0LnRvU2l0ZSk7XG5cbiAgICAgICAgbGV0IG5ld1RpY2tlciA9IG5ldyBUaWNrZXIoXG4gICAgICAgICAgICByZXF1ZXN0LnRpY2tlclN5bWJvbCxcbiAgICAgICAgICAgIHJlcXVlc3QudGlja2VyTmFtZSxcbiAgICAgICAgICAgIG5ldyBUaWNrZXJUeXBlKHJlcXVlc3QudGlja2VyVHlwZSlcbiAgICAgICAgKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJzZXJ2aWNlV29ya2VyIHRpY2tlcjogXCIgKyBuZXdUaWNrZXIudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgbGV0IHVybCA9IHRvU2l0ZS5jcmVhdGVVcmxGb3JUaWNrZXIobmV3VGlja2VyKTtcbiAgICAgICAgY2hyb21lLnRhYnMuY3JlYXRlKHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgaW5kZXg6IHJlcXVlc3QuaW5kZXgsXG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoZnVuY3Rpb24gb3BlbkhvbWVwYWdlKFxuICAgIHJlcXVlc3QsXG4gICAgc2VuZGVyLFxuICAgIHNlbmRSZXNwb25zZVxuKSB7XG4gICAgaWYgKHJlcXVlc3QubWVzc2FnZSA9PT0gXCJvcGVuX2hvbWVwYWdlXCIpIHtcbiAgICAgICAgbGV0IHRvU2l0ZSA9IGRldGVybWluZVNpdGUocmVxdWVzdC50b1NpdGUpO1xuXG4gICAgICAgIGxldCB1cmwgPSB0b1NpdGUuYmFzZVVybDtcbiAgICAgICAgY29uc29sZS5sb2coXCJzZXJ2aWNlV29ya2VyIG9wZW5faG9tZXBhZ2UgdXJsOiBcIiArIHVybCk7XG5cbiAgICAgICAgY2hyb21lLnRhYnMuY3JlYXRlKHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgaW5kZXg6IHJlcXVlc3QuaW5kZXgsXG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuXG5mdW5jdGlvbiBkZXRlcm1pbmVTaXRlKHNpdGU6IHN0cmluZyk6IFNpdGUge1xuICAgIGNvbnNvbGUubG9nKFwiZGV0ZXJtaW5lU2l0ZShzaXRlKTogXCIgKyBzaXRlKTtcbiAgICBzaXRlID0gc2l0ZS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChzaXRlLmluY2x1ZGVzKFwicm9iaW5ob29kXCIpKSB7XG4gICAgICAgIHJldHVybiBuZXcgUm9iaW5ob29kKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG5ldyBZYWhvb0ZpbmFuY2UoKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlVXJsRm9yVGlja2VyIiwidGlja2VyIiwidGlja2VyVHlwZSIsInZhbHVlIiwidGhpcyIsImJhc2VVcmwiLCJzeW1ib2wiLCJnZXRUaWNrZXIiLCJ1cmwiLCJkb2N1bWVudCIsImdldFRpY2tlckZyb21VcmwiLCJnZXROYW1lIiwiZ2V0VGlja2VyVHlwZSIsInNwbGl0QXJyYXkiLCJzcGxpdCIsImxhc3RJbmRleCIsImxlbmd0aCIsInRyaW0iLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJpc0NyeXB0byIsImluY2x1ZGVzIiwiaXNFdGYiLCJpc05vUmVzdWx0c1BhZ2UiLCJpc1RpY2tlclVybCIsInN0YXJ0c1dpdGgiLCJuYW1lIiwiRVhDRVBUSU9OX1RJQ0tFUlMiLCJNYXAiLCJpcyIsInNpdGUiLCJjcnlwdG9BcmciLCJ4Iiwic2V0IiwicyIsImNvbnZlcnRQZXJpb2RUb0h5cGhlbiIsImNoZWNrRXhjZXB0aW9uTGlzdCIsInRvU3RyaW5nIiwidGlja2VyU3RyaW5nIiwiZ2V0VGlja2VyRnJvbVBhZ2UiLCJ0aWNrZXJTdHIiLCJ0dFN0ciIsImlzT3V0Z29pbmciLCJhcmdBcnJheSIsImV4Y2VwdGlvbkl0ZXJhdG9yIiwiZW50cmllcyIsInBhaXIiLCJrZXlBcnJheSIsInZhbEFycmF5IiwiZ2V0UXVvdGVIZWFkZXJJbmZvSWQiLCJuYW1lV2l0aFRpY2tlclJlbW92ZWQiLCJnZXRDb21wYW55SGVhZGVyIiwicmVtb3ZlRXh0cmFXaGl0ZXNwYWNlIiwiY2xlYW5lZFVwU3ltYm9sIiwicXVvdGVTdW1tYXJ5IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb252ZXJ0SHlwaGVuVG9QZXJpb2QiLCJ1dGlscyIsInJlcGxhY2UiLCJlcXVhbHMiLCJ0aGF0IiwibmFtZUVxdWFscyIsInRoYXROYW1lIiwidGhpc05hbWUiLCJ0b0xvd2VyQ2FzZSIsIlZBTElEX1RZUEVTIiwiaXNWYWxpZFR5cGUiLCJFcnJvciIsInR0Iiwic3RyIiwicmVnZXgiLCJSZWdFeHAiLCJmdWxsIiwiZm9yRWFjaCIsIndvcmQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJkZXRlcm1pbmVTaXRlIiwiY29uc29sZSIsImxvZyIsImNocm9tZSIsImFjdGlvbiIsIm9uQ2xpY2tlZCIsImFkZExpc3RlbmVyIiwidGFiIiwidGFicyIsInF1ZXJ5IiwiYWN0aXZlIiwibGFzdEZvY3VzZWRXaW5kb3ciLCJhY3RpdmVUYWIiLCJpbmRleCIsInNlbmRNZXNzYWdlIiwiaWQiLCJtZXNzYWdlIiwicnVudGltZSIsIm9uTWVzc2FnZSIsInJlcXVlc3QiLCJzZW5kZXIiLCJzZW5kUmVzcG9uc2UiLCJ0b1NpdGUiLCJuZXdUaWNrZXIiLCJ0aWNrZXJTeW1ib2wiLCJ0aWNrZXJOYW1lIiwiY3JlYXRlIl0sInNvdXJjZVJvb3QiOiIifQ==