(()=>{"use strict";var t={776:(t,e,r)=>{r.d(e,{G:()=>u});var o,n=r(199),i=r(219),c=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(){return t.call(this,"Robinhood","https://robinhood.com")||this}return c(e,t),e.prototype.createUrlForTicker=function(t){return"crypto"===t.tickerType.value?"".concat(this.baseUrl,"/").concat(t.tickerType.value,"/").concat(t.symbol):"".concat(this.baseUrl,"/stocks/").concat(t.symbol)},e.prototype.getTicker=function(t,e){return new i.v(this.getTickerFromUrl(t),this.getName(e),this.getTickerType(this,t,e))},e.prototype.getTickerFromUrl=function(t){var e=t.split("/"),r=e.length-1,o=e[r];return 0===o.trim().length&&(o=e[r-1]),o},e.prototype.getName=function(t){return t.querySelector("main h1").textContent.trim()},e.prototype.isCrypto=function(t){return t.includes("crypto")},e.prototype.isEtf=function(t){return!(null===t.querySelector("#etf-category"))},e.prototype.isNoResultsPage=function(t){return t.querySelector("html title").textContent.includes("Page not found")},e}(n.T)},199:(t,e,r)=>{r.d(e,{T:()=>n});var o=r(110),n=function(){function t(t,e){this.EXCEPTION_TICKERS=new Map,this.name=t,this.baseUrl=e}return t.prototype.is=function(){return this.name},t.prototype.createUrlForTicker=function(t){},t.prototype.getTicker=function(t,e){},t.prototype.getTickerType=function(t,e,r){return t.isEtf(r)?new o.C("etf"):t.isCrypto(e)?new o.C("crypto"):new o.C("stock")},t.prototype.getName=function(t){},t.prototype.isCrypto=function(t){},t.prototype.isEtf=function(t){},t.prototype.isNoResultsPage=function(t){},t}()},455:(t,e,r)=>{r.d(e,{k:()=>s});var o,n=r(199),i=r(219),c=r(700),u=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(){var e=t.call(this,"YahooFinance","https://finance.yahoo.com")||this;return e.EXCEPTION_TICKERS.set(["GRT6719","crypto"],["GRT","crypto"]),e}return u(e,t),e.prototype.createUrlForTicker=function(t){var e=t.convertPeriodToHyphen(t.symbol);return e=this.checkExceptionList(e,t.tickerType.toString(),!1),"crypto"===t.tickerType.value&&(e+="-USD"),"".concat(this.baseUrl,"/quote/").concat(e)},e.prototype.getTicker=function(t,e){var r=this.getTickerFromPage(e,this.isCrypto(e)),o=this.getTickerType(this,e,e);return new i.v(this.checkExceptionList(r,o.toString(),!0),this.getName(e),o)},e.prototype.checkExceptionList=function(t,e,r){var o,n,i=[t,e],c=this.EXCEPTION_TICKERS.entries();try{for(var u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(c),s=u.next();!s.done;s=u.next()){var a=s.value,p=void 0,l=void 0;if(r?(p=a[0],l=a[1]):(p=a[1],l=a[0]),i[0]===p[0]&&i[1]===p[1]){t=l[0];break}}}catch(t){o={error:t}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}return t},e.prototype.getQuoteHeaderInfoId=function(){return"#quote-header-info"},e.prototype.getName=function(t){var e=this.getCompanyHeader(t).split(" (")[0];return(new c.c).removeExtraWhitespace(e)},e.prototype.getTickerFromPage=function(t,e){var r=this.getCompanyHeader(t).split(" (")[1];return r=r.split(")")[0],e&&(r=r.split("-")[0]),r},e.prototype.getCompanyHeader=function(t){return t.querySelector(this.getQuoteHeaderInfoId()+" h1").textContent.trim()},e.prototype.isCrypto=function(t){return t.querySelector(this.getQuoteHeaderInfoId()).textContent.includes("CoinMarketCap")},e.prototype.isEtf=function(t){var e=t.querySelector("#quote-summary");return(new c.c).removeExtraWhitespace(e.textContent).includes("Net Assets")},e.prototype.isNoResultsPage=function(t){return!!t.getElementById("lookup-page")},e}(n.T)},219:(t,e,r)=>{r.d(e,{v:()=>n});var o=r(700),n=function(){function t(t,e,r){this.symbol=this.convertHyphenToPeriod(t);var n=new o.c;this.name=n.removeExtraWhitespace(e),this.tickerType=r}return t.prototype.convertHyphenToPeriod=function(t){return t.replace("-",".")},t.prototype.convertPeriodToHyphen=function(t){return t.replace(".","-")},t.prototype.toString=function(){return"Ticker - symbol: ".concat(this.symbol,", name: ").concat(this.name,", type: ").concat(this.tickerType)},t.prototype.equals=function(t){return this.symbol===t.symbol&&this.nameEquals(t.name)&&this.tickerType.equals(t.tickerType)},t.prototype.nameEquals=function(t){var e=this.name.toLowerCase();return t=t.toLowerCase(),e.includes(t)||t.includes(e)},t}()},110:(t,e,r)=>{r.d(e,{C:()=>o});var o=function(){function t(t){if(this.VALID_TYPES=["stock","etf","mutualfund","crypto","future","bond"],t=t.toLowerCase().trim(),!this.isValidType(t))throw new Error("Invalid tickerType: "+t);this.value=t}return t.prototype.isValidType=function(t){return this.VALID_TYPES.includes(t)},t.prototype.toString=function(){return this.value},t.prototype.equals=function(t){return this.value===t.value},t}()},700:(t,e,r)=>{r.d(e,{c:()=>o});var o=function(){function t(){}return t.prototype.removeExtraWhitespace=function(t){var e=new RegExp("\\s+"),r=t.split(e),o="";return r.forEach((function(t){o=o+t.trim()+" "})),o.trim()},t}()}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,r),i.exports}r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=r(455),e=r(110),o=r(219),n=r(776);function i(e){return console.log("determineSite(site): "+e),(e=e.toLowerCase()).includes("robinhood")?new n.G:new t.k}chrome.action.onClicked.addListener((function(t){chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){var r=e[0],o=r.index;chrome.tabs.sendMessage(r.id,{message:"clicked_browser_action",url:t.url,index:o+1})}))})),chrome.runtime.onMessage.addListener((function(t,r,n){if("open_new_tab"===t.message){var c=i(t.toSite),u=new o.v(t.tickerSymbol,t.tickerName,new e.C(t.tickerType));console.log("serviceWorker ticker: "+u.toString());var s=c.createUrlForTicker(u);chrome.tabs.create({url:s,index:t.index})}})),chrome.runtime.onMessage.addListener((function(t,e,r){if("open_homepage"===t.message){var o=i(t.toSite).baseUrl;console.log("serviceWorker open_homepage url: "+o),chrome.tabs.create({url:o,index:t.index})}}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy9zaXRlcy9TaXRlLnRzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlLy4vc3JjL3NpdGVzL1lhaG9vRmluYW5jZS50cyIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy90aWNrZXJzL1RpY2tlci50cyIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy90aWNrZXJzL1RpY2tlclR5cGUudHMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvdXRpbHMvVXRpbHMudHMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2Uvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2Uvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvc2VydmljZVdvcmtlcnMvc2VydmljZVdvcmtlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaXRlIH0gZnJvbSBcIi4vU2l0ZVwiO1xuaW1wb3J0IHsgVGlja2VyVHlwZSB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclR5cGVcIjtcbmltcG9ydCB7IFRpY2tlciB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclwiO1xuXG5leHBvcnQgY2xhc3MgUm9iaW5ob29kIGV4dGVuZHMgU2l0ZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiUm9iaW5ob29kXCIsIGBodHRwczovL3JvYmluaG9vZC5jb21gKTtcbiAgICB9XG5cbiAgICBjcmVhdGVVcmxGb3JUaWNrZXIodGlja2VyOiBUaWNrZXIpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGlja2VyLnRpY2tlclR5cGUudmFsdWUgPT09IFwiY3J5cHRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLmJhc2VVcmx9LyR7dGlja2VyLnRpY2tlclR5cGUudmFsdWV9LyR7dGlja2VyLnN5bWJvbH1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRVRGcyBhbHNvIGdldCB0aGUgJ3N0b2NrcycgcGF0aCBpbiB0aGUgdXJsIG9uIFJIXG4gICAgICAgICAgICByZXR1cm4gYCR7dGhpcy5iYXNlVXJsfS9zdG9ja3MvJHt0aWNrZXIuc3ltYm9sfWA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRUaWNrZXIodXJsOiBzdHJpbmcsIGRvY3VtZW50OiBEb2N1bWVudCk6IFRpY2tlciB7XG4gICAgICAgIHJldHVybiBuZXcgVGlja2VyKFxuICAgICAgICAgICAgdGhpcy5nZXRUaWNrZXJGcm9tVXJsKHVybCksXG4gICAgICAgICAgICB0aGlzLmdldE5hbWUoZG9jdW1lbnQpLFxuICAgICAgICAgICAgdGhpcy5nZXRUaWNrZXJUeXBlKHRoaXMsIHVybCwgZG9jdW1lbnQpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHVybCAtIHRoaXMgcGFnZSdzIHVybFxuICAgICAqIEByZXR1cm5zIGp1c3QgdGhlIHRpY2tlciBzZWN0aW9uIG9mIHRoZSBnaXZlbiB1cmxcbiAgICAgKi9cbiAgICBnZXRUaWNrZXJGcm9tVXJsKHVybDogc3RyaW5nKSB7XG4gICAgICAgIGxldCBzcGxpdEFycmF5ID0gdXJsLnNwbGl0KFwiL1wiKTtcblxuICAgICAgICBsZXQgbGFzdEluZGV4ID0gc3BsaXRBcnJheS5sZW5ndGggLSAxO1xuICAgICAgICBsZXQgdGlja2VyID0gc3BsaXRBcnJheVtsYXN0SW5kZXhdO1xuICAgICAgICBpZiAodGlja2VyLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRpY2tlciA9IHNwbGl0QXJyYXlbbGFzdEluZGV4IC0gMV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGlja2VyO1xuICAgIH1cblxuICAgIGdldE5hbWUoZG9jdW1lbnQ6IERvY3VtZW50KTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluIGgxXCIpLnRleHRDb250ZW50LnRyaW0oKTtcbiAgICB9XG5cbiAgICBpc0NyeXB0byh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdXJsLmluY2x1ZGVzKFwiY3J5cHRvXCIpO1xuICAgIH1cblxuICAgIGlzRXRmKGRvY3VtZW50OiBEb2N1bWVudCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXRmQ2F0ZWdvcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2V0Zi1jYXRlZ29yeVwiKTtcbiAgICAgICAgcmV0dXJuICEoZXRmQ2F0ZWdvcnkgPT09IG51bGwpO1xuICAgIH1cblxuICAgIGlzTm9SZXN1bHRzUGFnZShkb2N1bWVudDogRG9jdW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcihcImh0bWwgdGl0bGVcIilcbiAgICAgICAgICAgIC50ZXh0Q29udGVudC5pbmNsdWRlcyhcIlBhZ2Ugbm90IGZvdW5kXCIpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRpY2tlciB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclwiO1xuaW1wb3J0IHsgVGlja2VyVHlwZSB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclR5cGVcIjtcblxuLyoqXG4gKiBQYXJlbnQgY2xhc3MgZm9yIG9iamVjdHMgaG9sZGluZyBpbmZvcm1hdGlvblxuICogYWJvdXQgYSBwYXJ0aWN1bGFyIHdlYnNpdGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBTaXRlIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYmFzZVVybDogc3RyaW5nO1xuICAgIEVYQ0VQVElPTl9USUNLRVJTOiBNYXA8YW55LCBhbnk+ID0gbmV3IE1hcCgpO1xuXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBiYXNlVXJsOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgbmFtZSBvZiB0aGUgc2l0ZVxuICAgICAqL1xuICAgIGlzKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBUaWNrZXIsIGNyZWF0ZSB0aGUgYXBwcm9wcmlhdGUgdXJsIGZvciB0aGF0IFRpY2tlclxuICAgICAqIG9uIHRoaXMgU2l0ZS5cbiAgICAgKiBAcGFyYW0gdGlja2VyIC0gdGhlIFRpY2tlciBmb3Igd2hpY2ggd2UncmUgY3JlYXRpbmcgYSB1cmxcbiAgICAgKi9cbiAgICBjcmVhdGVVcmxGb3JUaWNrZXIodGlja2VyOiBUaWNrZXIpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIFB1bGwgYWxsIG5lY2Vzc2FyeSBpbmZvcm1hdGlvbiBmcm9tIHRoZSBjdXJyZW50IHVybFxuICAgICAqIGFuZCBwYWdlIHRvIGNyZWF0ZSBhIFRpY2tlciBvYmplY3QgdG8gc2VuZCB0byBvdGhlciBTaXRlc1xuICAgICAqIEBwYXJhbSB1cmwgLSB1cmwgb2YgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIERPTSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICovXG4gICAgZ2V0VGlja2VyKHVybDogc3RyaW5nLCBkb2N1bWVudDogRG9jdW1lbnQpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZSB0aGUgdHlwZSBvZiB0aWNrZXIgZm9yIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKiAoc3RvY2ssIGNyeXB0bywgZXRjKVxuICAgICAqIEBwYXJhbSBzaXRlIC0gdGhlIFNpdGUgd2hpY2ggdGhlIHVzZXIgaXMgY3VycmVudGx5IG9uXG4gICAgICogQHBhcmFtIGNyeXB0b0FyZyAtIHNvbWUgc2l0ZXMgbWF5IG5lZWQgYSBzZXBhcmF0ZSB3YXkgdG8gaWRlbnRpZnkgd2hldGhlciBvciBub3QgdGhlIHBhZ2UgaXMgYSBjcnlwdG8gcGFnZSAoc3VjaCBhcyB0aGUgdXJsKS5cbiAgICAgKiBJZiB0aGF0J3MgdGhlIGNhc2UsIHRoYXQgYXJnIGdvZXMgaGVyZS4gT3RoZXJ3aXNlLCB0aGUgRG9jdW1lbnQgcGFyYW0gaXMgdXN1YWxseSBzZW50IHR3aWNlLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIHRoZSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZSwgYXMgYSBEb2N1bWVudCBvYmplY3QuXG4gICAgICogQHJldHVybnMgVGlja2VyVHlwZSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICovXG4gICAgZ2V0VGlja2VyVHlwZShzaXRlOiBTaXRlLCBjcnlwdG9Bcmc6IGFueSwgZG9jdW1lbnQ6IERvY3VtZW50KTogVGlja2VyVHlwZSB7XG4gICAgICAgIGlmIChzaXRlLmlzRXRmKGRvY3VtZW50KSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXJUeXBlKFwiZXRmXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHNpdGUuaXNDcnlwdG8oY3J5cHRvQXJnKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXJUeXBlKFwiY3J5cHRvXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXJUeXBlKFwic3RvY2tcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdHlwZSBmb3IgdGhlIG1ldGhvZHMgYmVsb3cgaXMgXCJhbnlcIiwgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHJldHVybiBhIHZhbHVlIGluIHRoZSBzdXBlcmNsYXNzLCB3aGljaCB3ZSB3b3VsZCBoYXZlIHRvIHNpbmNlIHdlJ3JlIHVzaW5nIHRoZW0gaW4gZ2V0VGlja2VyVHlwZSBhYm92ZS5cbiAgICAvLyBJbXBsZW1lbnRhdGlvbnMgb2YgdGhlc2UgbWV0aG9kcyBpbiBzdWJjbGFzc2VzIHNob3VsZCByZXR1cm4gYSBib29sZWFuLlxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjb21wYW55J3MgZnVsbCBuYW1lXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gRE9NIGNvbnRlbnQgb2YgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqL1xuICAgIGdldE5hbWUoZG9jdW1lbnQ6IERvY3VtZW50KTogYW55IHt9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGN1cnJlbnQgcGFnZSBpcyBmb3IgYSBjcnlwdG9jdXJyZW5jeSxcbiAgICAgKiBmYWxzZSBvdGhlcndpc2UuXG4gICAgICogQHBhcmFtIHggLSBhcmcgb2YgYW55IHR5cGUgd2hpY2ggd2lsbCBoZWxwIGEgcGFydGl1bGFyIHNpdGVcbiAgICAgKiBpZGVudGlmeSBhIGNyeXB0b2N1cnJlbmN5IHBhZ2UuXG4gICAgICovXG4gICAgaXNDcnlwdG8oeDogYW55KTogYW55IHt9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGN1cnJlbnQgcGFnZSBpcyBmb3IgYW4gRVRGLFxuICAgICAqIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZS5cbiAgICAgKi9cbiAgICBpc0V0Zihkb2N1bWVudDogRG9jdW1lbnQpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY3VycmVudCBwYWdlIGlzIGEgTm8gUmVzdWx0cyBwYWdlLFxuICAgICAqIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gb2YgdGhlIGN1cnJlbnQgcGFnZS5cbiAgICAgKi9cbiAgICBpc05vUmVzdWx0c1BhZ2UoZG9jdW1lbnQ6IERvY3VtZW50KTogYW55IHt9XG59XG4iLCJpbXBvcnQgeyBTaXRlIH0gZnJvbSBcIi4vU2l0ZVwiO1xuaW1wb3J0IHsgVGlja2VyVHlwZSB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclR5cGVcIjtcbmltcG9ydCB7IFRpY2tlciB9IGZyb20gXCIuLi90aWNrZXJzL1RpY2tlclwiO1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvVXRpbHNcIjtcblxuZXhwb3J0IGNsYXNzIFlhaG9vRmluYW5jZSBleHRlbmRzIFNpdGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcIllhaG9vRmluYW5jZVwiLCBgaHR0cHM6Ly9maW5hbmNlLnlhaG9vLmNvbWApO1xuXG4gICAgICAgIHRoaXMuRVhDRVBUSU9OX1RJQ0tFUlMuc2V0KFtcIkdSVDY3MTlcIiwgXCJjcnlwdG9cIl0sIFtcIkdSVFwiLCBcImNyeXB0b1wiXSk7XG4gICAgfVxuXG4gICAgY3JlYXRlVXJsRm9yVGlja2VyKHRpY2tlcjogVGlja2VyKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHM6IHN0cmluZyA9IHRpY2tlci5jb252ZXJ0UGVyaW9kVG9IeXBoZW4odGlja2VyLnN5bWJvbCk7XG5cbiAgICAgICAgcyA9IHRoaXMuY2hlY2tFeGNlcHRpb25MaXN0KHMsIHRpY2tlci50aWNrZXJUeXBlLnRvU3RyaW5nKCksIGZhbHNlKTtcblxuICAgICAgICAvLyBJZiB0aGUgcGFnZSB0aGF0IHdlJ3JlIG9uIGlzIGZvciBhIHN0b2NrIG9yIEVURiwgdGhlbiB3ZSBjYW4ganVzdCBsZWF2ZSB0aGUgdGlja2VyIGFzLWlzLlxuICAgICAgICAvLyBJZiB0aGUgcGFnZSB0aGF0IHdlJ3JlIG9uIGlzIGZvciBhIGNyeXB0b2N1cnJlbmN5LCB0aGVuIHdlIG5lZWRcbiAgICAgICAgLy8gdG8gYWRqdXN0IHRoZSB0aWNrZXIgdG8gYWRkIHRoZSBcInF1b3RlIGN1cnJlbmN5XCIgLS1cbiAgICAgICAgLy8gdGhlIGN1cnJlbmN5IGZvciB3aGljaCB3ZSdyZSBkaXNwbGF5aW5nIHRoZSBleGNoYW5nZSByYXRlIHRvIHRoZSBjcnlwdG9jdXJyZW5jeS5cbiAgICAgICAgLy8gQnkgZGVmYXVsdCwgd2UnbGwgdXNlIHRoZSBVUyBEb2xsYXIgKFwiVVNEXCIpLlxuICAgICAgICAvLyBUT0RPOiBBbGxvdyB1c2VyIHRvIHNlbGVjdCB0aGVpciBwcmVmZXJyZWQgcXVvdGUgY3VycmVuY3kgaW4gT3B0aW9ucyBtZW51LlxuICAgICAgICBpZiAodGlja2VyLnRpY2tlclR5cGUudmFsdWUgPT09IFwiY3J5cHRvXCIpIHtcbiAgICAgICAgICAgIHMgPSBzICsgYC1VU0RgO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmJhc2VVcmx9L3F1b3RlLyR7c31gO1xuICAgIH1cblxuICAgIGdldFRpY2tlcih1cmw6IHN0cmluZywgZG9jdW1lbnQ6IERvY3VtZW50KTogVGlja2VyIHtcbiAgICAgICAgbGV0IHRpY2tlclN0cmluZzogc3RyaW5nID0gdGhpcy5nZXRUaWNrZXJGcm9tUGFnZShcbiAgICAgICAgICAgIGRvY3VtZW50LFxuICAgICAgICAgICAgdGhpcy5pc0NyeXB0byhkb2N1bWVudClcbiAgICAgICAgKTtcbiAgICAgICAgbGV0IHRpY2tlclR5cGU6IFRpY2tlclR5cGUgPSB0aGlzLmdldFRpY2tlclR5cGUoXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgICAgICBkb2N1bWVudFxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBuZXcgVGlja2VyKFxuICAgICAgICAgICAgdGhpcy5jaGVja0V4Y2VwdGlvbkxpc3QodGlja2VyU3RyaW5nLCB0aWNrZXJUeXBlLnRvU3RyaW5nKCksIHRydWUpLFxuICAgICAgICAgICAgdGhpcy5nZXROYW1lKGRvY3VtZW50KSxcbiAgICAgICAgICAgIHRpY2tlclR5cGVcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGVyZSBhcmUgYSBmZXcgb3V0bGllciBzZWN1cml0aWVzIHdoaWNoIGRvIG5vdCBhYmlkZSBieSB0aGUgdXJsIGNyZWF0aW9uXG4gICAgICogcnVsZXMgd2hpY2ggYXJlIG5vcm1hbGx5IHVzZWQgb24gY2VydGFpbiBzaXRlcy4gVG8gaGFuZGxlIHRoZXNlIGNhc2VzLCB3ZSBuZWVkIHRvXG4gICAgICogY2hlY2sgdG8gc2VlIGlmIG91ciB0aWNrZXIgZmFsbHMgaW50byB0aGlzIHNtYWxsIHNldCBvZiBleGNlcHRpb25zLFxuICAgICAqIGFuZCBpZiBzbywgdG8gY29udmVydCBpdCB0byB0aGUgY29ycmVjdCB0aWNrZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGlja2VyU3RyIC0gdGhlIHRpY2tlciB3aGljaCB3ZSdyZSBjaGVja2luZyB0byBzZWUgaWYgaXQncyBvbiB0aGUgZXhjZXB0aW9uIGxpc3RcbiAgICAgKiBAcGFyYW0gdHRTdHIgLSB0aGUgdGlja2VyIHR5cGUgb2YgdGhlIGdpdmVuIHRpY2tlclxuICAgICAqIEBwYXJhbSBpc091dGdvaW5nIC0gdHJ1ZSBpZiB3ZSdyZSBjb252ZXJ0aW5nIHRoZSB0aWNrZXIgdG9cbiAgICAgKiB1c2UgaXQgZm9yIGEgZGlmZmVyZW50IHNpdGUsIGZhbHNlIGlmIHRoaXMgaXMgYW4gaW5jb21pbmcgdGlja2VyXG4gICAgICogd2hpY2ggd2UncmUgY29udmVydGluZyBmb3IgdXNlIG9uICp0aGlzKiBzaXRlLlxuICAgICAqIEByZXR1cm5zIHRoZSBjb3JyZWN0IHRpY2tlciBzdHJpbmcsIHdoZXRoZXIgaXQgbmVlZGVkIHRvIGJlIGFkanVzdGVkIG9yIG5vdC5cbiAgICAgKi9cbiAgICBjaGVja0V4Y2VwdGlvbkxpc3QoXG4gICAgICAgIHRpY2tlclN0cjogc3RyaW5nLFxuICAgICAgICB0dFN0cjogc3RyaW5nLFxuICAgICAgICBpc091dGdvaW5nOiBib29sZWFuXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGFyZ0FycmF5ID0gW3RpY2tlclN0ciwgdHRTdHJdO1xuICAgICAgICBsZXQgZXhjZXB0aW9uSXRlcmF0b3IgPSB0aGlzLkVYQ0VQVElPTl9USUNLRVJTLmVudHJpZXMoKTtcbiAgICAgICAgZm9yIChsZXQgcGFpciBvZiBleGNlcHRpb25JdGVyYXRvcikge1xuICAgICAgICAgICAgbGV0IGtleUFycmF5O1xuICAgICAgICAgICAgbGV0IHZhbEFycmF5O1xuICAgICAgICAgICAgaWYgKGlzT3V0Z29pbmcpIHtcbiAgICAgICAgICAgICAgICBrZXlBcnJheSA9IHBhaXJbMF07XG4gICAgICAgICAgICAgICAgdmFsQXJyYXkgPSBwYWlyWzFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBrZXlBcnJheSA9IHBhaXJbMV07XG4gICAgICAgICAgICAgICAgdmFsQXJyYXkgPSBwYWlyWzBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXJnQXJyYXlbMF0gPT09IGtleUFycmF5WzBdICYmIGFyZ0FycmF5WzFdID09PSBrZXlBcnJheVsxXSkge1xuICAgICAgICAgICAgICAgIHRpY2tlclN0ciA9IHZhbEFycmF5WzBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRpY2tlclN0cjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyBpZCBmb3IgdGhlIHF1b3RlIGhlYWRlciBlbGVtZW50XG4gICAgICovXG4gICAgZ2V0UXVvdGVIZWFkZXJJbmZvSWQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwiI3F1b3RlLWhlYWRlci1pbmZvXCI7XG4gICAgfVxuXG4gICAgZ2V0TmFtZShkb2N1bWVudDogRG9jdW1lbnQpOiBzdHJpbmcge1xuICAgICAgICBsZXQgbmFtZSA9IHRoaXMuZ2V0Q29tcGFueUhlYWRlcihkb2N1bWVudCk7XG4gICAgICAgIGxldCBuYW1lV2l0aFRpY2tlclJlbW92ZWQgPSBuYW1lLnNwbGl0KFwiIChcIilbMF07XG4gICAgICAgIGxldCB1dGlscyA9IG5ldyBVdGlscygpO1xuICAgICAgICByZXR1cm4gdXRpbHMucmVtb3ZlRXh0cmFXaGl0ZXNwYWNlKG5hbWVXaXRoVGlja2VyUmVtb3ZlZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmluZCB0aGUgdGlja2VyIHN5bWJvbCBpbiB0aGUgcGFnZSwgYW5kIHNlcGFyYXRlIGl0IGZyb20gYW55IHVubmVjZXNzYXJ5IHRleHRcbiAgICAgKiB3aGljaCBzdXJyb3VuZHMgaXQuXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gRE9NIG9mIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKiBAcGFyYW0gaXNDcnlwdG8gLSB0cnVlIGlmIHRoZSBjdXJyZW50IHBhZ2UgaXMgZm9yIGEgY3J5cHRvY3VycmVuY3ksXG4gICAgICogZmFsc2Ugb3RoZXJ3aXNlXG4gICAgICogQHJldHVybnMgdGlja2VyIHN5bWJvbFxuICAgICAqL1xuICAgIGdldFRpY2tlckZyb21QYWdlKGRvY3VtZW50OiBEb2N1bWVudCwgaXNDcnlwdG86IGJvb2xlYW4pOiBzdHJpbmcge1xuICAgICAgICBsZXQgbmFtZSA9IHRoaXMuZ2V0Q29tcGFueUhlYWRlcihkb2N1bWVudCk7XG4gICAgICAgIGxldCBjbGVhbmVkVXBTeW1ib2wgPSBuYW1lLnNwbGl0KFwiIChcIilbMV07XG4gICAgICAgIGNsZWFuZWRVcFN5bWJvbCA9IGNsZWFuZWRVcFN5bWJvbC5zcGxpdChcIilcIilbMF07XG4gICAgICAgIGlmIChpc0NyeXB0bykge1xuICAgICAgICAgICAgY2xlYW5lZFVwU3ltYm9sID0gY2xlYW5lZFVwU3ltYm9sLnNwbGl0KFwiLVwiKVswXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGVhbmVkVXBTeW1ib2w7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gRE9NIG9mIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKiBAcmV0dXJucyB0ZXh0IGNvbnRlbnQgb2YgdGhlIGNvbXBhbnkgaGVhZGVyIGVsZW1lbnRcbiAgICAgKi9cbiAgICBnZXRDb21wYW55SGVhZGVyKGRvY3VtZW50OiBEb2N1bWVudCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5nZXRRdW90ZUhlYWRlckluZm9JZCgpICsgXCIgaDFcIilcbiAgICAgICAgICAgIC50ZXh0Q29udGVudC50cmltKCk7XG4gICAgfVxuXG4gICAgaXNDcnlwdG8oZG9jdW1lbnQ6IERvY3VtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBxdW90ZUhlYWRlckluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgdGhpcy5nZXRRdW90ZUhlYWRlckluZm9JZCgpXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBxdW90ZUhlYWRlckluZm8udGV4dENvbnRlbnQuaW5jbHVkZXMoXCJDb2luTWFya2V0Q2FwXCIpO1xuICAgIH1cblxuICAgIGlzRXRmKGRvY3VtZW50OiBEb2N1bWVudCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgcXVvdGVTdW1tYXJ5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNxdW90ZS1zdW1tYXJ5XCIpO1xuICAgICAgICBsZXQgdXRpbHMgPSBuZXcgVXRpbHMoKTtcblxuICAgICAgICBsZXQgdGV4dENsZWFuZWRVcCA9IHV0aWxzLnJlbW92ZUV4dHJhV2hpdGVzcGFjZShcbiAgICAgICAgICAgIHF1b3RlU3VtbWFyeS50ZXh0Q29udGVudFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gdGV4dENsZWFuZWRVcC5pbmNsdWRlcyhcIk5ldCBBc3NldHNcIik7XG4gICAgfVxuXG4gICAgaXNOb1Jlc3VsdHNQYWdlKGRvY3VtZW50OiBEb2N1bWVudCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvb2t1cC1wYWdlXCIpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFRpY2tlclR5cGUgfSBmcm9tIFwiLi9UaWNrZXJUeXBlXCI7XG5pbXBvcnQgeyBVdGlscyB9IGZyb20gXCIuLi91dGlscy9VdGlsc1wiO1xuXG5leHBvcnQgY2xhc3MgVGlja2VyIHtcbiAgICBzeW1ib2w6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdGlja2VyVHlwZTogVGlja2VyVHlwZTtcblxuICAgIGNvbnN0cnVjdG9yKHN5bWJvbDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIHRpY2tlclR5cGU6IFRpY2tlclR5cGUpIHtcbiAgICAgICAgdGhpcy5zeW1ib2wgPSB0aGlzLmNvbnZlcnRIeXBoZW5Ub1BlcmlvZChzeW1ib2wpO1xuICAgICAgICBsZXQgdXRpbHMgPSBuZXcgVXRpbHMoKTtcbiAgICAgICAgdGhpcy5uYW1lID0gdXRpbHMucmVtb3ZlRXh0cmFXaGl0ZXNwYWNlKG5hbWUpO1xuICAgICAgICB0aGlzLnRpY2tlclR5cGUgPSB0aWNrZXJUeXBlO1xuICAgIH1cblxuICAgIGNvbnZlcnRIeXBoZW5Ub1BlcmlvZChzeW1ib2w6IHN0cmluZykge1xuICAgICAgICByZXR1cm4gc3ltYm9sLnJlcGxhY2UoXCItXCIsIFwiLlwiKTtcbiAgICB9XG5cbiAgICBjb252ZXJ0UGVyaW9kVG9IeXBoZW4oc3ltYm9sOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN5bWJvbC5yZXBsYWNlKFwiLlwiLCBcIi1cIik7XG4gICAgfVxuXG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBUaWNrZXIgLSBzeW1ib2w6ICR7dGhpcy5zeW1ib2x9LCBuYW1lOiAke3RoaXMubmFtZX0sIHR5cGU6ICR7dGhpcy50aWNrZXJUeXBlfWA7XG4gICAgfVxuXG4gICAgZXF1YWxzKHRoYXQ6IFRpY2tlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgdGhpcy5zeW1ib2wgPT09IHRoYXQuc3ltYm9sICYmXG4gICAgICAgICAgICB0aGlzLm5hbWVFcXVhbHModGhhdC5uYW1lKSAmJlxuICAgICAgICAgICAgdGhpcy50aWNrZXJUeXBlLmVxdWFscyh0aGF0LnRpY2tlclR5cGUpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgdG8gc2VlIGlmIGEgZ2l2ZW4gY29tcGFueSdzIG5hbWUgbWF0Y2hlcyB0aGlzIGNvbXBhbnkncyBuYW1lLlxuICAgICAqIFNpbmNlIHRoZXNlIHZhbHVlcyBhcmUgYmVpbmcgcHVsbGVkIGZyb20gZWFjaCBzaXRlIHdlJ3JlIHZpc2l0aW5nIChhbmQgd2UgY2FuJ3QgY29udHJvbCB3aGF0IHRoZXkgY2FsbCB0aGVtKSxcbiAgICAgKiBhbmQgc2luY2UgdGhlc2UgZXF1YWxpdHkgZnVuY3Rpb25zIGFyZSAoYXQgbGVhc3Qgc28gZmFyKSBvbmx5IGJlaW5nIHVzZWQgdG8gZmFjaWxpdGF0ZSB1bml0IHRlc3RpbmcgYW55d2F5LFxuICAgICAqIHRoaXMgZnVuY3Rpb24gaXMgYmFzaWNhbGx5IGp1c3QgY2hlY2tpbmcgdG8gc2VlIGlmIHRoZSBuYW1lcyBhcmUgXCJjbG9zZSBlbm91Z2hcIiBieSBjaGVja2luZyB0byBzZWUgaWYgb25lIHN0cmluZyBpbmNsdWRlcyB0aGUgb3RoZXIuXG4gICAgICpcbiAgICAgKiBGb3IgZXhhbXBsZSwgdGhlIFJIIHBhZ2UgZm9yICRTUFkgY2FsbHMgaXQgXCJTUERSIFMmUCA1MDAgRVRGXCIsIHdoaWxlIFlGIGNhbGxzIGl0IFwiU1BEUiBTJlAgNTAwIEVURiBUcnVzdFwiLlxuICAgICAqIEV2ZW4gdGhvdWdoIHRoZSBzdHJpbmdzIGFyZW4ndCBpZGVudGljYWwsIHdlIHN0aWxsIHdhbnQgdGhlc2UgdG8gYmUgY29uc2lkZXJlZCBlcXVhbCwgc28gd2UgY2FuIGp1c3QgY2hlY2sgaWYgb25lIGNvbnRhaW5zIHRoZSBvdGhlciwgd2hpY2ggaXQgZG9lcy5cbiAgICAgKlxuICAgICAqIFRPRE8gLSB0aGVyZSB3aWxsIHByb2JhYmx5IGJlIHNvbWUgZWRnZSBjYXNlcyBmb3Igd2hpY2ggdGhpcyBzb2x1dGlvbiB3aWxsIG5vdCB3b3JrLCBzbyB0aGlzIHdpbGwgbGlrZWx5IGhhdmUgdG8gYmUgcmV2aXNlZCBpbiB0aGUgZnV0dXJlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRoYXROYW1lIC0gbmFtZSBvZiB0aGUgY29tcGFueSB0byB3aGljaCB3ZSdyZSBjb21wYXJpbmcgdGhpcyBjb21wYW55XG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgY29tcGFuaWVzJyBuYW1lcyBhcmUgdGhlIHNhbWUgKG9yIGF0IGxlYXN0LCBjbG9zZSBlbm91Z2gpXG4gICAgICovXG4gICAgbmFtZUVxdWFscyh0aGF0TmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB0aGlzTmFtZSA9IHRoaXMubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB0aGF0TmFtZSA9IHRoYXROYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXNOYW1lLmluY2x1ZGVzKHRoYXROYW1lKSB8fCB0aGF0TmFtZS5pbmNsdWRlcyh0aGlzTmFtZSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFRpY2tlclR5cGUge1xuICAgIFZBTElEX1RZUEVTID0gW1wic3RvY2tcIiwgXCJldGZcIiwgXCJtdXR1YWxmdW5kXCIsIFwiY3J5cHRvXCIsIFwiZnV0dXJlXCIsIFwiYm9uZFwiXTtcbiAgICB2YWx1ZTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IodGlja2VyVHlwZTogc3RyaW5nKSB7XG4gICAgICAgIHRpY2tlclR5cGUgPSB0aWNrZXJUeXBlLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgICAgICBpZiAodGhpcy5pc1ZhbGlkVHlwZSh0aWNrZXJUeXBlKSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRpY2tlclR5cGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHRpY2tlclR5cGU6IFwiICsgdGlja2VyVHlwZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gdHQgLSBUaWNrZXJUeXBlIGFzIGEgc3RyaW5nXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gc3RyaW5nIGlzIHdpdGhpblxuICAgICAqIHRoZSBWQUxJRF9UWVBFUyBsaXN0LCBmYWxzZSBvdGhlcndpc2VcbiAgICAgKi9cbiAgICBpc1ZhbGlkVHlwZSh0dDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLlZBTElEX1RZUEVTLmluY2x1ZGVzKHR0KTtcbiAgICB9XG5cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgICB9XG5cbiAgICBlcXVhbHModGhhdDogVGlja2VyVHlwZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZSA9PT0gdGhhdC52YWx1ZTtcbiAgICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVXRpbHMge1xuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgbGFyZ2UgY2h1bmtzIG9mIHdoaXRlc3BhY2UgZnJvbSBhIGdpdmVuIHN0cmluZyxcbiAgICAgKiByZXBsYWNpbmcgZWFjaCB3aXRoIGp1c3QgYSBzaW5nbGUgc3BhY2UuXG4gICAgICogQHBhcmFtIHN0ciAtIHRleHQgd2hpY2ggY29udGFpbnMgZXhjZXNzIHdoaXRlc3BhY2VcbiAgICAgKiBAcmV0dXJucyBzdHJpbmcgd2l0aCBleGNlc3Mgd2hpdGVzcGFjZSByZW1vdmVkXG4gICAgICovXG4gICAgcmVtb3ZlRXh0cmFXaGl0ZXNwYWNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcXFxzK1wiKTtcbiAgICAgICAgbGV0IHNwbGl0ID0gc3RyLnNwbGl0KHJlZ2V4KTtcbiAgICAgICAgbGV0IGZ1bGwgPSBcIlwiO1xuICAgICAgICBzcGxpdC5mb3JFYWNoKGZ1bmN0aW9uICh3b3JkKSB7XG4gICAgICAgICAgICBmdWxsID0gZnVsbCArIHdvcmQudHJpbSgpICsgXCIgXCI7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBHZXQgcmlkIG9mIHRoZSBvbmUgZXh0cmEgc3BhY2UgYXQgdGhlIGVuZCBiZWZvcmUgd2UgcmV0dXJuXG4gICAgICAgIHJldHVybiBmdWxsLnRyaW0oKTtcbiAgICB9XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCB7IFlhaG9vRmluYW5jZSB9IGZyb20gXCIuLi9zaXRlcy9ZYWhvb0ZpbmFuY2VcIjtcbmltcG9ydCB7IFRpY2tlclR5cGUgfSBmcm9tIFwiLi4vdGlja2Vycy9UaWNrZXJUeXBlXCI7XG5pbXBvcnQgeyBUaWNrZXIgfSBmcm9tIFwiLi4vdGlja2Vycy9UaWNrZXJcIjtcbmltcG9ydCB7IFJvYmluaG9vZCB9IGZyb20gXCIuLi9zaXRlcy9Sb2Jpbmhvb2RcIjtcbmltcG9ydCB7IFNpdGUgfSBmcm9tIFwiLi4vc2l0ZXMvU2l0ZVwiO1xuXG4vLyBDYWxsZWQgd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gdGhlIGJyb3dzZXIgYWN0aW9uLlxuY2hyb21lLmFjdGlvbi5vbkNsaWNrZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gaW5qZWN0KHRhYikge1xuICAgIGNocm9tZS50YWJzLnF1ZXJ5KFxuICAgICAgICB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBsYXN0Rm9jdXNlZFdpbmRvdzogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgICAgZnVuY3Rpb24gKHRhYnMpIHtcbiAgICAgICAgICAgIHZhciBhY3RpdmVUYWIgPSB0YWJzWzBdO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gYWN0aXZlVGFiLmluZGV4O1xuICAgICAgICAgICAgY2hyb21lLnRhYnMuc2VuZE1lc3NhZ2UoYWN0aXZlVGFiLmlkLCB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJjbGlja2VkX2Jyb3dzZXJfYWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgdXJsOiB0YWIudXJsLFxuICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleCArIDEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICk7XG59KTtcblxuLy8gT3BlbiBuZXcgdGFiXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoZnVuY3Rpb24gb3Blbk5ld1RhYihcbiAgICByZXF1ZXN0LFxuICAgIHNlbmRlcixcbiAgICBzZW5kUmVzcG9uc2Vcbikge1xuICAgIGlmIChyZXF1ZXN0Lm1lc3NhZ2UgPT09IFwib3Blbl9uZXdfdGFiXCIpIHtcbiAgICAgICAgbGV0IHRvU2l0ZSA9IGRldGVybWluZVNpdGUocmVxdWVzdC50b1NpdGUpO1xuXG4gICAgICAgIGxldCBuZXdUaWNrZXIgPSBuZXcgVGlja2VyKFxuICAgICAgICAgICAgcmVxdWVzdC50aWNrZXJTeW1ib2wsXG4gICAgICAgICAgICByZXF1ZXN0LnRpY2tlck5hbWUsXG4gICAgICAgICAgICBuZXcgVGlja2VyVHlwZShyZXF1ZXN0LnRpY2tlclR5cGUpXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2VydmljZVdvcmtlciB0aWNrZXI6IFwiICsgbmV3VGlja2VyLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIGxldCB1cmwgPSB0b1NpdGUuY3JlYXRlVXJsRm9yVGlja2VyKG5ld1RpY2tlcik7XG4gICAgICAgIGNocm9tZS50YWJzLmNyZWF0ZSh7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIGluZGV4OiByZXF1ZXN0LmluZGV4LFxuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyKGZ1bmN0aW9uIG9wZW5Ib21lcGFnZShcbiAgICByZXF1ZXN0LFxuICAgIHNlbmRlcixcbiAgICBzZW5kUmVzcG9uc2Vcbikge1xuICAgIGlmIChyZXF1ZXN0Lm1lc3NhZ2UgPT09IFwib3Blbl9ob21lcGFnZVwiKSB7XG4gICAgICAgIGxldCB0b1NpdGUgPSBkZXRlcm1pbmVTaXRlKHJlcXVlc3QudG9TaXRlKTtcblxuICAgICAgICBsZXQgdXJsID0gdG9TaXRlLmJhc2VVcmw7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2VydmljZVdvcmtlciBvcGVuX2hvbWVwYWdlIHVybDogXCIgKyB1cmwpO1xuXG4gICAgICAgIGNocm9tZS50YWJzLmNyZWF0ZSh7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIGluZGV4OiByZXF1ZXN0LmluZGV4LFxuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuZnVuY3Rpb24gZGV0ZXJtaW5lU2l0ZShzaXRlOiBzdHJpbmcpOiBTaXRlIHtcbiAgICBjb25zb2xlLmxvZyhcImRldGVybWluZVNpdGUoc2l0ZSk6IFwiICsgc2l0ZSk7XG4gICAgc2l0ZSA9IHNpdGUudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoc2l0ZS5pbmNsdWRlcyhcInJvYmluaG9vZFwiKSkge1xuICAgICAgICByZXR1cm4gbmV3IFJvYmluaG9vZCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgWWFob29GaW5hbmNlKCk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVVybEZvclRpY2tlciIsInRpY2tlciIsInRpY2tlclR5cGUiLCJ2YWx1ZSIsInRoaXMiLCJiYXNlVXJsIiwic3ltYm9sIiwiZ2V0VGlja2VyIiwidXJsIiwiZG9jdW1lbnQiLCJnZXRUaWNrZXJGcm9tVXJsIiwiZ2V0TmFtZSIsImdldFRpY2tlclR5cGUiLCJzcGxpdEFycmF5Iiwic3BsaXQiLCJsYXN0SW5kZXgiLCJsZW5ndGgiLCJ0cmltIiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiaXNDcnlwdG8iLCJpbmNsdWRlcyIsImlzRXRmIiwiaXNOb1Jlc3VsdHNQYWdlIiwibmFtZSIsIkVYQ0VQVElPTl9USUNLRVJTIiwiTWFwIiwiaXMiLCJzaXRlIiwiY3J5cHRvQXJnIiwieCIsInNldCIsInMiLCJjb252ZXJ0UGVyaW9kVG9IeXBoZW4iLCJjaGVja0V4Y2VwdGlvbkxpc3QiLCJ0b1N0cmluZyIsInRpY2tlclN0cmluZyIsImdldFRpY2tlckZyb21QYWdlIiwidGlja2VyU3RyIiwidHRTdHIiLCJpc091dGdvaW5nIiwiYXJnQXJyYXkiLCJleGNlcHRpb25JdGVyYXRvciIsImVudHJpZXMiLCJwYWlyIiwia2V5QXJyYXkiLCJ2YWxBcnJheSIsImdldFF1b3RlSGVhZGVySW5mb0lkIiwibmFtZVdpdGhUaWNrZXJSZW1vdmVkIiwiZ2V0Q29tcGFueUhlYWRlciIsInJlbW92ZUV4dHJhV2hpdGVzcGFjZSIsImNsZWFuZWRVcFN5bWJvbCIsInF1b3RlU3VtbWFyeSIsImdldEVsZW1lbnRCeUlkIiwiY29udmVydEh5cGhlblRvUGVyaW9kIiwidXRpbHMiLCJyZXBsYWNlIiwiZXF1YWxzIiwidGhhdCIsIm5hbWVFcXVhbHMiLCJ0aGF0TmFtZSIsInRoaXNOYW1lIiwidG9Mb3dlckNhc2UiLCJWQUxJRF9UWVBFUyIsImlzVmFsaWRUeXBlIiwiRXJyb3IiLCJ0dCIsInN0ciIsInJlZ2V4IiwiUmVnRXhwIiwiZnVsbCIsImZvckVhY2giLCJ3b3JkIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZGV0ZXJtaW5lU2l0ZSIsImNvbnNvbGUiLCJsb2ciLCJjaHJvbWUiLCJhY3Rpb24iLCJvbkNsaWNrZWQiLCJhZGRMaXN0ZW5lciIsInRhYiIsInRhYnMiLCJxdWVyeSIsImFjdGl2ZSIsImxhc3RGb2N1c2VkV2luZG93IiwiYWN0aXZlVGFiIiwiaW5kZXgiLCJzZW5kTWVzc2FnZSIsImlkIiwibWVzc2FnZSIsInJ1bnRpbWUiLCJvbk1lc3NhZ2UiLCJyZXF1ZXN0Iiwic2VuZGVyIiwic2VuZFJlc3BvbnNlIiwidG9TaXRlIiwibmV3VGlja2VyIiwidGlja2VyU3ltYm9sIiwidGlja2VyTmFtZSIsImNyZWF0ZSJdLCJzb3VyY2VSb290IjoiIn0=