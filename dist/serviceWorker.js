(()=>{"use strict";var t={776:(t,e,r)=>{r.d(e,{G:()=>u});var o,n=r(199),i=r(219),c=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(){return t.call(this,"Robinhood","https://robinhood.com")||this}return c(e,t),e.prototype.createUrlForTicker=function(t){return"crypto"===t.tickerType.value?"".concat(this.baseUrl,"/").concat(t.tickerType.value,"/").concat(t.symbol):"".concat(this.baseUrl,"/stocks/").concat(t.symbol)},e.prototype.getTicker=function(t,e){return new i.v(this.getTickerFromUrl(t),this.getName(e),this.getTickerType(this,t,e))},e.prototype.getTickerFromUrl=function(t){var e=t.split("/"),r=e.length-1,o=e[r];return 0===o.trim().length&&(o=e[r-1]),o},e.prototype.getName=function(t){return t.querySelector("main h1").textContent.trim()},e.prototype.isCrypto=function(t){return t.includes("crypto")},e.prototype.isEtf=function(t){return!(null===t.querySelector("#etf-category"))},e.prototype.isNoResultsPage=function(t){return t.querySelector("html title").textContent.includes("Page not found")},e.prototype.isTickerUrl=function(t){return t.includes("https://robinhood.com")&&(t.includes("stocks")||t.includes("crypto"))},e}(n.T)},199:(t,e,r)=>{r.d(e,{T:()=>n});var o=r(110),n=function(){function t(t,e){this.EXCEPTION_TICKERS=new Map,this.name=t,this.baseUrl=e}return t.prototype.is=function(){return this.name},t.prototype.createUrlForTicker=function(t){},t.prototype.getTicker=function(t,e){},t.prototype.getTickerType=function(t,e,r){return t.isEtf(r)?new o.C("etf"):t.isCrypto(e)?new o.C("crypto"):new o.C("stock")},t.prototype.getName=function(t){},t.prototype.isCrypto=function(t){},t.prototype.isEtf=function(t){},t.prototype.isNoResultsPage=function(t){},t.prototype.isTickerUrl=function(t){},t}()},455:(t,e,r)=>{r.d(e,{k:()=>s});var o,n=r(199),i=r(219),c=r(700),u=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(){var e=t.call(this,"YahooFinance","https://finance.yahoo.com")||this;return e.EXCEPTION_TICKERS.set(["GRT6719","crypto"],["GRT","crypto"]),e}return u(e,t),e.prototype.createUrlForTicker=function(t){var e=t.convertPeriodToHyphen(t.symbol);return e=this.checkExceptionList(e,t.tickerType.toString(),!1),"crypto"===t.tickerType.value&&(e+="-USD"),"".concat(this.baseUrl,"/quote/").concat(e)},e.prototype.getTicker=function(t,e){var r=this.getTickerFromPage(e,this.isCrypto(e)),o=this.getTickerType(this,e,e);return new i.v(this.checkExceptionList(r,o.toString(),!0),this.getName(e),o)},e.prototype.checkExceptionList=function(t,e,r){var o,n,i=[t,e],c=this.EXCEPTION_TICKERS.entries();try{for(var u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(c),s=u.next();!s.done;s=u.next()){var a=s.value,p=void 0,l=void 0;if(r?(p=a[0],l=a[1]):(p=a[1],l=a[0]),i[0]===p[0]&&i[1]===p[1]){t=l[0];break}}}catch(t){o={error:t}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}return t},e.prototype.getQuoteHeaderInfoId=function(){return"#quote-header-info"},e.prototype.getName=function(t){var e=this.getCompanyHeader(t).split(" (")[0];return(new c.c).removeExtraWhitespace(e)},e.prototype.getTickerFromPage=function(t,e){var r=this.getCompanyHeader(t).split(" (")[1];return r=r.split(")")[0],e&&(r=r.split("-")[0]),r},e.prototype.getCompanyHeader=function(t){return t.querySelector(this.getQuoteHeaderInfoId()+" h1").textContent.trim()},e.prototype.isCrypto=function(t){return t.querySelector(this.getQuoteHeaderInfoId()).textContent.includes("CoinMarketCap")},e.prototype.isEtf=function(t){var e=t.querySelector("#quote-summary");return(new c.c).removeExtraWhitespace(e.textContent).includes("Net Assets")},e.prototype.isNoResultsPage=function(t){return!!t.getElementById("lookup-page")},e.prototype.isTickerUrl=function(t){return t.startsWith("https://finance.yahoo.com/quote/")},e}(n.T)},219:(t,e,r)=>{r.d(e,{v:()=>n});var o=r(700),n=function(){function t(t,e,r){this.symbol=this.convertHyphenToPeriod(t);var n=new o.c;this.name=n.removeExtraWhitespace(e),this.tickerType=r}return t.prototype.convertHyphenToPeriod=function(t){return t.replace("-",".")},t.prototype.convertPeriodToHyphen=function(t){return t.replace(".","-")},t.prototype.toString=function(){return"Ticker - symbol: ".concat(this.symbol,", name: ").concat(this.name,", type: ").concat(this.tickerType)},t.prototype.equals=function(t){return this.symbol===t.symbol&&this.nameEquals(t.name)&&this.tickerType.equals(t.tickerType)},t.prototype.nameEquals=function(t){var e=this.name.toLowerCase();return t=t.toLowerCase(),e.includes(t)||t.includes(e)},t}()},110:(t,e,r)=>{r.d(e,{C:()=>o});var o=function(){function t(t){if(this.VALID_TYPES=["stock","etf","mutualfund","crypto","future","bond"],t=t.toLowerCase().trim(),!this.isValidType(t))throw new Error("Invalid tickerType: "+t);this.value=t}return t.prototype.isValidType=function(t){return this.VALID_TYPES.includes(t)},t.prototype.toString=function(){return this.value},t.prototype.equals=function(t){return this.value===t.value},t}()},700:(t,e,r)=>{r.d(e,{c:()=>o});var o=function(){function t(){}return t.prototype.removeExtraWhitespace=function(t){var e=new RegExp("\\s+"),r=t.split(e),o="";return r.forEach((function(t){o=o+t.trim()+" "})),o.trim()},t}()}},e={};function r(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,r),i.exports}r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=r(455),e=r(110),o=r(219),n=r(776);function i(e){return console.log("determineSite(site): "+e),(e=e.toLowerCase()).includes("robinhood")?new n.G:new t.k}chrome.action.onClicked.addListener((function(t){chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){var r=e[0],o=r.index;chrome.tabs.sendMessage(r.id,{message:"clicked_browser_action",url:t.url,index:o+1})}))})),chrome.runtime.onMessage.addListener((function(t,r,n){if("open_new_tab"===t.message){var c=i(t.toSite),u=new o.v(t.tickerSymbol,t.tickerName,new e.C(t.tickerType));console.log("serviceWorker ticker: "+u.toString());var s=c.createUrlForTicker(u);chrome.tabs.create({url:s,index:t.index})}})),chrome.runtime.onMessage.addListener((function(t,e,r){if("open_homepage"===t.message){var o=i(t.toSite).baseUrl;console.log("serviceWorker open_homepage url: "+o),chrome.tabs.create({url:o,index:t.index})}}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2pCNEYsUUFBUUMsSUFBSSxvQ0FBc0MxRixHQUVsRDJGLE9BQU9LLEtBQUtrQixPQUFPLENBQ2ZsSCxJQUFLQSxFQUNMcUcsTUFBT00sRUFBUU4sTyxDQUczQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvc2l0ZXMvUm9iaW5ob29kLnRzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlLy4vc3JjL3NpdGVzL1NpdGUudHMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2UvLi9zcmMvc2l0ZXMvWWFob29GaW5hbmNlLnRzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlLy4vc3JjL3RpY2tlcnMvVGlja2VyLnRzIiwid2VicGFjazovL3JvYmluaG9vZHRveWFob29maW5hbmNlLy4vc3JjL3RpY2tlcnMvVGlja2VyVHlwZS50cyIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy91dGlscy9VdGlscy50cyIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcm9iaW5ob29kdG95YWhvb2ZpbmFuY2Uvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9yb2Jpbmhvb2R0b3lhaG9vZmluYW5jZS8uL3NyYy9zZXJ2aWNlV29ya2Vycy9zZXJ2aWNlV29ya2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNpdGUgfSBmcm9tIFwiLi9TaXRlXCI7XG5pbXBvcnQgeyBUaWNrZXJUeXBlIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyVHlwZVwiO1xuaW1wb3J0IHsgVGlja2VyIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyXCI7XG5cbmV4cG9ydCBjbGFzcyBSb2Jpbmhvb2QgZXh0ZW5kcyBTaXRlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJSb2Jpbmhvb2RcIiwgYGh0dHBzOi8vcm9iaW5ob29kLmNvbWApO1xuICAgIH1cblxuICAgIGNyZWF0ZVVybEZvclRpY2tlcih0aWNrZXI6IFRpY2tlcik6IHN0cmluZyB7XG4gICAgICAgIGlmICh0aWNrZXIudGlja2VyVHlwZS52YWx1ZSA9PT0gXCJjcnlwdG9cIikge1xuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMuYmFzZVVybH0vJHt0aWNrZXIudGlja2VyVHlwZS52YWx1ZX0vJHt0aWNrZXIuc3ltYm9sfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBFVEZzIGFsc28gZ2V0IHRoZSAnc3RvY2tzJyBwYXRoIGluIHRoZSB1cmwgb24gUkhcbiAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLmJhc2VVcmx9L3N0b2Nrcy8ke3RpY2tlci5zeW1ib2x9YDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFRpY2tlcih1cmw6IHN0cmluZywgZG9jdW1lbnQ6IERvY3VtZW50KTogVGlja2VyIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUaWNrZXIoXG4gICAgICAgICAgICB0aGlzLmdldFRpY2tlckZyb21VcmwodXJsKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0TmFtZShkb2N1bWVudCksXG4gICAgICAgICAgICB0aGlzLmdldFRpY2tlclR5cGUodGhpcywgdXJsLCBkb2N1bWVudClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gdXJsIC0gdGhpcyBwYWdlJ3MgdXJsXG4gICAgICogQHJldHVybnMganVzdCB0aGUgdGlja2VyIHNlY3Rpb24gb2YgdGhlIGdpdmVuIHVybFxuICAgICAqL1xuICAgIGdldFRpY2tlckZyb21VcmwodXJsOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IHNwbGl0QXJyYXkgPSB1cmwuc3BsaXQoXCIvXCIpO1xuXG4gICAgICAgIGxldCBsYXN0SW5kZXggPSBzcGxpdEFycmF5Lmxlbmd0aCAtIDE7XG4gICAgICAgIGxldCB0aWNrZXIgPSBzcGxpdEFycmF5W2xhc3RJbmRleF07XG4gICAgICAgIGlmICh0aWNrZXIudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGlja2VyID0gc3BsaXRBcnJheVtsYXN0SW5kZXggLSAxXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aWNrZXI7XG4gICAgfVxuXG4gICAgZ2V0TmFtZShkb2N1bWVudDogRG9jdW1lbnQpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW4gaDFcIikudGV4dENvbnRlbnQudHJpbSgpO1xuICAgIH1cblxuICAgIGlzQ3J5cHRvKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB1cmwuaW5jbHVkZXMoXCJjcnlwdG9cIik7XG4gICAgfVxuXG4gICAgaXNFdGYoZG9jdW1lbnQ6IERvY3VtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBldGZDYXRlZ29yeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZXRmLWNhdGVnb3J5XCIpO1xuICAgICAgICByZXR1cm4gIShldGZDYXRlZ29yeSA9PT0gbnVsbCk7XG4gICAgfVxuXG4gICAgaXNOb1Jlc3VsdHNQYWdlKGRvY3VtZW50OiBEb2N1bWVudCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiaHRtbCB0aXRsZVwiKVxuICAgICAgICAgICAgLnRleHRDb250ZW50LmluY2x1ZGVzKFwiUGFnZSBub3QgZm91bmRcIik7XG4gICAgfVxuXG4gICAgaXNUaWNrZXJVcmwodXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHVybC5pbmNsdWRlcyhcImh0dHBzOi8vcm9iaW5ob29kLmNvbVwiKSAmJlxuICAgICAgICAgICAgKHVybC5pbmNsdWRlcyhcInN0b2Nrc1wiKSB8fCB1cmwuaW5jbHVkZXMoXCJjcnlwdG9cIikpXG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVGlja2VyIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyXCI7XG5pbXBvcnQgeyBUaWNrZXJUeXBlIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyVHlwZVwiO1xuXG4vKipcbiAqIFBhcmVudCBjbGFzcyBmb3Igb2JqZWN0cyBob2xkaW5nIGluZm9ybWF0aW9uXG4gKiBhYm91dCBhIHBhcnRpY3VsYXIgd2Vic2l0ZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFNpdGUge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBiYXNlVXJsOiBzdHJpbmc7XG4gICAgRVhDRVBUSU9OX1RJQ0tFUlM6IE1hcDxhbnksIGFueT4gPSBuZXcgTWFwKCk7XG5cbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIGJhc2VVcmw6IHN0cmluZykge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBuYW1lIG9mIHRoZSBzaXRlXG4gICAgICovXG4gICAgaXMoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIFRpY2tlciwgY3JlYXRlIHRoZSBhcHByb3ByaWF0ZSB1cmwgZm9yIHRoYXQgVGlja2VyXG4gICAgICogb24gdGhpcyBTaXRlLlxuICAgICAqIEBwYXJhbSB0aWNrZXIgLSB0aGUgVGlja2VyIGZvciB3aGljaCB3ZSdyZSBjcmVhdGluZyBhIHVybFxuICAgICAqL1xuICAgIGNyZWF0ZVVybEZvclRpY2tlcih0aWNrZXI6IFRpY2tlcik6IGFueSB7fVxuXG4gICAgLyoqXG4gICAgICogUHVsbCBhbGwgbmVjZXNzYXJ5IGluZm9ybWF0aW9uIGZyb20gdGhlIGN1cnJlbnQgdXJsXG4gICAgICogYW5kIHBhZ2UgdG8gY3JlYXRlIGEgVGlja2VyIG9iamVjdCB0byBzZW5kIHRvIG90aGVyIFNpdGVzXG4gICAgICogQHBhcmFtIHVybCAtIHVybCBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gRE9NIG9mIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKi9cbiAgICBnZXRUaWNrZXIodXJsOiBzdHJpbmcsIGRvY3VtZW50OiBEb2N1bWVudCk6IGFueSB7fVxuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lIHRoZSB0eXBlIG9mIHRpY2tlciBmb3IgdGhlIGN1cnJlbnQgcGFnZVxuICAgICAqIChzdG9jaywgY3J5cHRvLCBldGMpXG4gICAgICogQHBhcmFtIHNpdGUgLSB0aGUgU2l0ZSB3aGljaCB0aGUgdXNlciBpcyBjdXJyZW50bHkgb25cbiAgICAgKiBAcGFyYW0gY3J5cHRvQXJnIC0gc29tZSBzaXRlcyBtYXkgbmVlZCBhIHNlcGFyYXRlIHdheSB0byBpZGVudGlmeSB3aGV0aGVyIG9yIG5vdCB0aGUgcGFnZSBpcyBhIGNyeXB0byBwYWdlIChzdWNoIGFzIHRoZSB1cmwpLlxuICAgICAqIElmIHRoYXQncyB0aGUgY2FzZSwgdGhhdCBhcmcgZ29lcyBoZXJlLiBPdGhlcndpc2UsIHRoZSBEb2N1bWVudCBwYXJhbSBpcyB1c3VhbGx5IHNlbnQgdHdpY2UuXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gdGhlIERPTSBvZiB0aGUgY3VycmVudCBwYWdlLCBhcyBhIERvY3VtZW50IG9iamVjdC5cbiAgICAgKiBAcmV0dXJucyBUaWNrZXJUeXBlIG9mIHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKi9cbiAgICBnZXRUaWNrZXJUeXBlKHNpdGU6IFNpdGUsIGNyeXB0b0FyZzogYW55LCBkb2N1bWVudDogRG9jdW1lbnQpOiBUaWNrZXJUeXBlIHtcbiAgICAgICAgaWYgKHNpdGUuaXNFdGYoZG9jdW1lbnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpY2tlclR5cGUoXCJldGZcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoc2l0ZS5pc0NyeXB0byhjcnlwdG9BcmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpY2tlclR5cGUoXCJjcnlwdG9cIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpY2tlclR5cGUoXCJzdG9ja1wiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiB0eXBlIGZvciB0aGUgbWV0aG9kcyBiZWxvdyBpcyBcImFueVwiLCBiZWNhdXNlIHdlIGRvbid0IHdhbnQgdG8gcmV0dXJuIGEgdmFsdWUgaW4gdGhlIHN1cGVyY2xhc3MsIHdoaWNoIHdlIHdvdWxkIGhhdmUgdG8gc2luY2Ugd2UncmUgdXNpbmcgdGhlbSBpbiBnZXRUaWNrZXJUeXBlIGFib3ZlLlxuICAgIC8vIEltcGxlbWVudGF0aW9ucyBvZiB0aGVzZSBtZXRob2RzIGluIHN1YmNsYXNzZXMgc2hvdWxkIHJldHVybiBhIGJvb2xlYW4uXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGNvbXBhbnkncyBmdWxsIG5hbWVcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBET00gY29udGVudCBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICovXG4gICAgZ2V0TmFtZShkb2N1bWVudDogRG9jdW1lbnQpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY3VycmVudCBwYWdlIGlzIGZvciBhIGNyeXB0b2N1cnJlbmN5LFxuICAgICAqIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKiBAcGFyYW0geCAtIGFyZyBvZiBhbnkgdHlwZSB3aGljaCB3aWxsIGhlbHAgYSBwYXJ0aXVsYXIgc2l0ZVxuICAgICAqIGlkZW50aWZ5IGEgY3J5cHRvY3VycmVuY3kgcGFnZS5cbiAgICAgKi9cbiAgICBpc0NyeXB0byh4OiBhbnkpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY3VycmVudCBwYWdlIGlzIGZvciBhbiBFVEYsXG4gICAgICogZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIERPTSBvZiB0aGUgY3VycmVudCBwYWdlLlxuICAgICAqL1xuICAgIGlzRXRmKGRvY3VtZW50OiBEb2N1bWVudCk6IGFueSB7fVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBjdXJyZW50IHBhZ2UgaXMgYSBObyBSZXN1bHRzIHBhZ2UsXG4gICAgICogZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIERPTSBvZiB0aGUgY3VycmVudCBwYWdlLlxuICAgICAqL1xuICAgIGlzTm9SZXN1bHRzUGFnZShkb2N1bWVudDogRG9jdW1lbnQpOiBhbnkge31cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB1cmwgLSB0aGUgY3VycmVudCBwYWdlJ3MgdXJsXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgdXJsIGluZGljYXRlcyB0aGF0IHRoZSBwYWdlIGlzIGZvciBvbmUgc3BlY2lmaWMgVGlja2VyLFxuICAgICAqIGZhbHNlIGlmIGl0J3MgYW55IG90aGVyIGtpbmQgb2YgcGFnZS5cbiAgICAgKi9cbiAgICBpc1RpY2tlclVybCh1cmw6IHN0cmluZyk6IGFueSB7fVxufVxuIiwiaW1wb3J0IHsgU2l0ZSB9IGZyb20gXCIuL1NpdGVcIjtcbmltcG9ydCB7IFRpY2tlclR5cGUgfSBmcm9tIFwiLi4vdGlja2Vycy9UaWNrZXJUeXBlXCI7XG5pbXBvcnQgeyBUaWNrZXIgfSBmcm9tIFwiLi4vdGlja2Vycy9UaWNrZXJcIjtcbmltcG9ydCB7IFV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1V0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBZYWhvb0ZpbmFuY2UgZXh0ZW5kcyBTaXRlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJZYWhvb0ZpbmFuY2VcIiwgYGh0dHBzOi8vZmluYW5jZS55YWhvby5jb21gKTtcblxuICAgICAgICB0aGlzLkVYQ0VQVElPTl9USUNLRVJTLnNldChbXCJHUlQ2NzE5XCIsIFwiY3J5cHRvXCJdLCBbXCJHUlRcIiwgXCJjcnlwdG9cIl0pO1xuICAgIH1cblxuICAgIGNyZWF0ZVVybEZvclRpY2tlcih0aWNrZXI6IFRpY2tlcik6IHN0cmluZyB7XG4gICAgICAgIGxldCBzOiBzdHJpbmcgPSB0aWNrZXIuY29udmVydFBlcmlvZFRvSHlwaGVuKHRpY2tlci5zeW1ib2wpO1xuXG4gICAgICAgIHMgPSB0aGlzLmNoZWNrRXhjZXB0aW9uTGlzdChzLCB0aWNrZXIudGlja2VyVHlwZS50b1N0cmluZygpLCBmYWxzZSk7XG5cbiAgICAgICAgLy8gSWYgdGhlIHBhZ2UgdGhhdCB3ZSdyZSBvbiBpcyBmb3IgYSBzdG9jayBvciBFVEYsIHRoZW4gd2UgY2FuIGp1c3QgbGVhdmUgdGhlIHRpY2tlciBhcy1pcy5cbiAgICAgICAgLy8gSWYgdGhlIHBhZ2UgdGhhdCB3ZSdyZSBvbiBpcyBmb3IgYSBjcnlwdG9jdXJyZW5jeSwgdGhlbiB3ZSBuZWVkXG4gICAgICAgIC8vIHRvIGFkanVzdCB0aGUgdGlja2VyIHRvIGFkZCB0aGUgXCJxdW90ZSBjdXJyZW5jeVwiIC0tXG4gICAgICAgIC8vIHRoZSBjdXJyZW5jeSBmb3Igd2hpY2ggd2UncmUgZGlzcGxheWluZyB0aGUgZXhjaGFuZ2UgcmF0ZSB0byB0aGUgY3J5cHRvY3VycmVuY3kuXG4gICAgICAgIC8vIEJ5IGRlZmF1bHQsIHdlJ2xsIHVzZSB0aGUgVVMgRG9sbGFyIChcIlVTRFwiKS5cbiAgICAgICAgLy8gVE9ETzogQWxsb3cgdXNlciB0byBzZWxlY3QgdGhlaXIgcHJlZmVycmVkIHF1b3RlIGN1cnJlbmN5IGluIE9wdGlvbnMgbWVudS5cbiAgICAgICAgaWYgKHRpY2tlci50aWNrZXJUeXBlLnZhbHVlID09PSBcImNyeXB0b1wiKSB7XG4gICAgICAgICAgICBzID0gcyArIGAtVVNEYDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7dGhpcy5iYXNlVXJsfS9xdW90ZS8ke3N9YDtcbiAgICB9XG5cbiAgICBnZXRUaWNrZXIodXJsOiBzdHJpbmcsIGRvY3VtZW50OiBEb2N1bWVudCk6IFRpY2tlciB7XG4gICAgICAgIGxldCB0aWNrZXJTdHJpbmc6IHN0cmluZyA9IHRoaXMuZ2V0VGlja2VyRnJvbVBhZ2UoXG4gICAgICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgICAgIHRoaXMuaXNDcnlwdG8oZG9jdW1lbnQpXG4gICAgICAgICk7XG4gICAgICAgIGxldCB0aWNrZXJUeXBlOiBUaWNrZXJUeXBlID0gdGhpcy5nZXRUaWNrZXJUeXBlKFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgIGRvY3VtZW50LFxuICAgICAgICAgICAgZG9jdW1lbnRcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gbmV3IFRpY2tlcihcbiAgICAgICAgICAgIHRoaXMuY2hlY2tFeGNlcHRpb25MaXN0KHRpY2tlclN0cmluZywgdGlja2VyVHlwZS50b1N0cmluZygpLCB0cnVlKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0TmFtZShkb2N1bWVudCksXG4gICAgICAgICAgICB0aWNrZXJUeXBlXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlcmUgYXJlIGEgZmV3IG91dGxpZXIgc2VjdXJpdGllcyB3aGljaCBkbyBub3QgYWJpZGUgYnkgdGhlIHVybCBjcmVhdGlvblxuICAgICAqIHJ1bGVzIHdoaWNoIGFyZSBub3JtYWxseSB1c2VkIG9uIGNlcnRhaW4gc2l0ZXMuIFRvIGhhbmRsZSB0aGVzZSBjYXNlcywgd2UgbmVlZCB0b1xuICAgICAqIGNoZWNrIHRvIHNlZSBpZiBvdXIgdGlja2VyIGZhbGxzIGludG8gdGhpcyBzbWFsbCBzZXQgb2YgZXhjZXB0aW9ucyxcbiAgICAgKiBhbmQgaWYgc28sIHRvIGNvbnZlcnQgaXQgdG8gdGhlIGNvcnJlY3QgdGlja2VyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHRpY2tlclN0ciAtIHRoZSB0aWNrZXIgd2hpY2ggd2UncmUgY2hlY2tpbmcgdG8gc2VlIGlmIGl0J3Mgb24gdGhlIGV4Y2VwdGlvbiBsaXN0XG4gICAgICogQHBhcmFtIHR0U3RyIC0gdGhlIHRpY2tlciB0eXBlIG9mIHRoZSBnaXZlbiB0aWNrZXJcbiAgICAgKiBAcGFyYW0gaXNPdXRnb2luZyAtIHRydWUgaWYgd2UncmUgY29udmVydGluZyB0aGUgdGlja2VyIHRvXG4gICAgICogdXNlIGl0IGZvciBhIGRpZmZlcmVudCBzaXRlLCBmYWxzZSBpZiB0aGlzIGlzIGFuIGluY29taW5nIHRpY2tlclxuICAgICAqIHdoaWNoIHdlJ3JlIGNvbnZlcnRpbmcgZm9yIHVzZSBvbiAqdGhpcyogc2l0ZS5cbiAgICAgKiBAcmV0dXJucyB0aGUgY29ycmVjdCB0aWNrZXIgc3RyaW5nLCB3aGV0aGVyIGl0IG5lZWRlZCB0byBiZSBhZGp1c3RlZCBvciBub3QuXG4gICAgICovXG4gICAgY2hlY2tFeGNlcHRpb25MaXN0KFxuICAgICAgICB0aWNrZXJTdHI6IHN0cmluZyxcbiAgICAgICAgdHRTdHI6IHN0cmluZyxcbiAgICAgICAgaXNPdXRnb2luZzogYm9vbGVhblxuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGxldCBhcmdBcnJheSA9IFt0aWNrZXJTdHIsIHR0U3RyXTtcbiAgICAgICAgbGV0IGV4Y2VwdGlvbkl0ZXJhdG9yID0gdGhpcy5FWENFUFRJT05fVElDS0VSUy5lbnRyaWVzKCk7XG4gICAgICAgIGZvciAobGV0IHBhaXIgb2YgZXhjZXB0aW9uSXRlcmF0b3IpIHtcbiAgICAgICAgICAgIGxldCBrZXlBcnJheTtcbiAgICAgICAgICAgIGxldCB2YWxBcnJheTtcbiAgICAgICAgICAgIGlmIChpc091dGdvaW5nKSB7XG4gICAgICAgICAgICAgICAga2V5QXJyYXkgPSBwYWlyWzBdO1xuICAgICAgICAgICAgICAgIHZhbEFycmF5ID0gcGFpclsxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAga2V5QXJyYXkgPSBwYWlyWzFdO1xuICAgICAgICAgICAgICAgIHZhbEFycmF5ID0gcGFpclswXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGFyZ0FycmF5WzBdID09PSBrZXlBcnJheVswXSAmJiBhcmdBcnJheVsxXSA9PT0ga2V5QXJyYXlbMV0pIHtcbiAgICAgICAgICAgICAgICB0aWNrZXJTdHIgPSB2YWxBcnJheVswXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aWNrZXJTdHI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMgaWQgZm9yIHRoZSBxdW90ZSBoZWFkZXIgZWxlbWVudFxuICAgICAqL1xuICAgIGdldFF1b3RlSGVhZGVySW5mb0lkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBcIiNxdW90ZS1oZWFkZXItaW5mb1wiO1xuICAgIH1cblxuICAgIGdldE5hbWUoZG9jdW1lbnQ6IERvY3VtZW50KTogc3RyaW5nIHtcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLmdldENvbXBhbnlIZWFkZXIoZG9jdW1lbnQpO1xuICAgICAgICBsZXQgbmFtZVdpdGhUaWNrZXJSZW1vdmVkID0gbmFtZS5zcGxpdChcIiAoXCIpWzBdO1xuICAgICAgICBsZXQgdXRpbHMgPSBuZXcgVXRpbHMoKTtcbiAgICAgICAgcmV0dXJuIHV0aWxzLnJlbW92ZUV4dHJhV2hpdGVzcGFjZShuYW1lV2l0aFRpY2tlclJlbW92ZWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgdGhlIHRpY2tlciBzeW1ib2wgaW4gdGhlIHBhZ2UsIGFuZCBzZXBhcmF0ZSBpdCBmcm9tIGFueSB1bm5lY2Vzc2FyeSB0ZXh0XG4gICAgICogd2hpY2ggc3Vycm91bmRzIGl0LlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIERPTSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICogQHBhcmFtIGlzQ3J5cHRvIC0gdHJ1ZSBpZiB0aGUgY3VycmVudCBwYWdlIGlzIGZvciBhIGNyeXB0b2N1cnJlbmN5LFxuICAgICAqIGZhbHNlIG90aGVyd2lzZVxuICAgICAqIEByZXR1cm5zIHRpY2tlciBzeW1ib2xcbiAgICAgKi9cbiAgICBnZXRUaWNrZXJGcm9tUGFnZShkb2N1bWVudDogRG9jdW1lbnQsIGlzQ3J5cHRvOiBib29sZWFuKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLmdldENvbXBhbnlIZWFkZXIoZG9jdW1lbnQpO1xuICAgICAgICBsZXQgY2xlYW5lZFVwU3ltYm9sID0gbmFtZS5zcGxpdChcIiAoXCIpWzFdO1xuICAgICAgICBjbGVhbmVkVXBTeW1ib2wgPSBjbGVhbmVkVXBTeW1ib2wuc3BsaXQoXCIpXCIpWzBdO1xuICAgICAgICBpZiAoaXNDcnlwdG8pIHtcbiAgICAgICAgICAgIGNsZWFuZWRVcFN5bWJvbCA9IGNsZWFuZWRVcFN5bWJvbC5zcGxpdChcIi1cIilbMF07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2xlYW5lZFVwU3ltYm9sO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIERPTSBvZiB0aGUgY3VycmVudCBwYWdlXG4gICAgICogQHJldHVybnMgdGV4dCBjb250ZW50IG9mIHRoZSBjb21wYW55IGhlYWRlciBlbGVtZW50XG4gICAgICovXG4gICAgZ2V0Q29tcGFueUhlYWRlcihkb2N1bWVudDogRG9jdW1lbnQpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuZ2V0UXVvdGVIZWFkZXJJbmZvSWQoKSArIFwiIGgxXCIpXG4gICAgICAgICAgICAudGV4dENvbnRlbnQudHJpbSgpO1xuICAgIH1cblxuICAgIGlzQ3J5cHRvKGRvY3VtZW50OiBEb2N1bWVudCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgcXVvdGVIZWFkZXJJbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgIHRoaXMuZ2V0UXVvdGVIZWFkZXJJbmZvSWQoKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gcXVvdGVIZWFkZXJJbmZvLnRleHRDb250ZW50LmluY2x1ZGVzKFwiQ29pbk1hcmtldENhcFwiKTtcbiAgICB9XG5cbiAgICBpc0V0Zihkb2N1bWVudDogRG9jdW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHF1b3RlU3VtbWFyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcXVvdGUtc3VtbWFyeVwiKTtcbiAgICAgICAgbGV0IHV0aWxzID0gbmV3IFV0aWxzKCk7XG5cbiAgICAgICAgbGV0IHRleHRDbGVhbmVkVXAgPSB1dGlscy5yZW1vdmVFeHRyYVdoaXRlc3BhY2UoXG4gICAgICAgICAgICBxdW90ZVN1bW1hcnkudGV4dENvbnRlbnRcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHRleHRDbGVhbmVkVXAuaW5jbHVkZXMoXCJOZXQgQXNzZXRzXCIpO1xuICAgIH1cblxuICAgIGlzTm9SZXN1bHRzUGFnZShkb2N1bWVudDogRG9jdW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICEhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb29rdXAtcGFnZVwiKTtcbiAgICB9XG5cbiAgICBpc1RpY2tlclVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdXJsLnN0YXJ0c1dpdGgoXCJodHRwczovL2ZpbmFuY2UueWFob28uY29tL3F1b3RlL1wiKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBUaWNrZXJUeXBlIH0gZnJvbSBcIi4vVGlja2VyVHlwZVwiO1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvVXRpbHNcIjtcblxuZXhwb3J0IGNsYXNzIFRpY2tlciB7XG4gICAgc3ltYm9sOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHRpY2tlclR5cGU6IFRpY2tlclR5cGU7XG5cbiAgICBjb25zdHJ1Y3RvcihzeW1ib2w6IHN0cmluZywgbmFtZTogc3RyaW5nLCB0aWNrZXJUeXBlOiBUaWNrZXJUeXBlKSB7XG4gICAgICAgIHRoaXMuc3ltYm9sID0gdGhpcy5jb252ZXJ0SHlwaGVuVG9QZXJpb2Qoc3ltYm9sKTtcbiAgICAgICAgbGV0IHV0aWxzID0gbmV3IFV0aWxzKCk7XG4gICAgICAgIHRoaXMubmFtZSA9IHV0aWxzLnJlbW92ZUV4dHJhV2hpdGVzcGFjZShuYW1lKTtcbiAgICAgICAgdGhpcy50aWNrZXJUeXBlID0gdGlja2VyVHlwZTtcbiAgICB9XG5cbiAgICBjb252ZXJ0SHlwaGVuVG9QZXJpb2Qoc3ltYm9sOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN5bWJvbC5yZXBsYWNlKFwiLVwiLCBcIi5cIik7XG4gICAgfVxuXG4gICAgY29udmVydFBlcmlvZFRvSHlwaGVuKHN5bWJvbDogc3RyaW5nKSB7XG4gICAgICAgIHJldHVybiBzeW1ib2wucmVwbGFjZShcIi5cIiwgXCItXCIpO1xuICAgIH1cblxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgVGlja2VyIC0gc3ltYm9sOiAke3RoaXMuc3ltYm9sfSwgbmFtZTogJHt0aGlzLm5hbWV9LCB0eXBlOiAke3RoaXMudGlja2VyVHlwZX1gO1xuICAgIH1cblxuICAgIGVxdWFscyh0aGF0OiBUaWNrZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHRoaXMuc3ltYm9sID09PSB0aGF0LnN5bWJvbCAmJlxuICAgICAgICAgICAgdGhpcy5uYW1lRXF1YWxzKHRoYXQubmFtZSkgJiZcbiAgICAgICAgICAgIHRoaXMudGlja2VyVHlwZS5lcXVhbHModGhhdC50aWNrZXJUeXBlKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIHRvIHNlZSBpZiBhIGdpdmVuIGNvbXBhbnkncyBuYW1lIG1hdGNoZXMgdGhpcyBjb21wYW55J3MgbmFtZS5cbiAgICAgKiBTaW5jZSB0aGVzZSB2YWx1ZXMgYXJlIGJlaW5nIHB1bGxlZCBmcm9tIGVhY2ggc2l0ZSB3ZSdyZSB2aXNpdGluZyAoYW5kIHdlIGNhbid0IGNvbnRyb2wgd2hhdCB0aGV5IGNhbGwgdGhlbSksXG4gICAgICogYW5kIHNpbmNlIHRoZXNlIGVxdWFsaXR5IGZ1bmN0aW9ucyBhcmUgKGF0IGxlYXN0IHNvIGZhcikgb25seSBiZWluZyB1c2VkIHRvIGZhY2lsaXRhdGUgdW5pdCB0ZXN0aW5nIGFueXdheSxcbiAgICAgKiB0aGlzIGZ1bmN0aW9uIGlzIGJhc2ljYWxseSBqdXN0IGNoZWNraW5nIHRvIHNlZSBpZiB0aGUgbmFtZXMgYXJlIFwiY2xvc2UgZW5vdWdoXCIgYnkgY2hlY2tpbmcgdG8gc2VlIGlmIG9uZSBzdHJpbmcgaW5jbHVkZXMgdGhlIG90aGVyLlxuICAgICAqXG4gICAgICogRm9yIGV4YW1wbGUsIHRoZSBSSCBwYWdlIGZvciAkU1BZIGNhbGxzIGl0IFwiU1BEUiBTJlAgNTAwIEVURlwiLCB3aGlsZSBZRiBjYWxscyBpdCBcIlNQRFIgUyZQIDUwMCBFVEYgVHJ1c3RcIi5cbiAgICAgKiBFdmVuIHRob3VnaCB0aGUgc3RyaW5ncyBhcmVuJ3QgaWRlbnRpY2FsLCB3ZSBzdGlsbCB3YW50IHRoZXNlIHRvIGJlIGNvbnNpZGVyZWQgZXF1YWwsIHNvIHdlIGNhbiBqdXN0IGNoZWNrIGlmIG9uZSBjb250YWlucyB0aGUgb3RoZXIsIHdoaWNoIGl0IGRvZXMuXG4gICAgICpcbiAgICAgKiBUT0RPIC0gdGhlcmUgd2lsbCBwcm9iYWJseSBiZSBzb21lIGVkZ2UgY2FzZXMgZm9yIHdoaWNoIHRoaXMgc29sdXRpb24gd2lsbCBub3Qgd29yaywgc28gdGhpcyB3aWxsIGxpa2VseSBoYXZlIHRvIGJlIHJldmlzZWQgaW4gdGhlIGZ1dHVyZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0aGF0TmFtZSAtIG5hbWUgb2YgdGhlIGNvbXBhbnkgdG8gd2hpY2ggd2UncmUgY29tcGFyaW5nIHRoaXMgY29tcGFueVxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGNvbXBhbmllcycgbmFtZXMgYXJlIHRoZSBzYW1lIChvciBhdCBsZWFzdCwgY2xvc2UgZW5vdWdoKVxuICAgICAqL1xuICAgIG5hbWVFcXVhbHModGhhdE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgdGhpc05hbWUgPSB0aGlzLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgdGhhdE5hbWUgPSB0aGF0TmFtZS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIHJldHVybiB0aGlzTmFtZS5pbmNsdWRlcyh0aGF0TmFtZSkgfHwgdGhhdE5hbWUuaW5jbHVkZXModGhpc05hbWUpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBUaWNrZXJUeXBlIHtcbiAgICBWQUxJRF9UWVBFUyA9IFtcInN0b2NrXCIsIFwiZXRmXCIsIFwibXV0dWFsZnVuZFwiLCBcImNyeXB0b1wiLCBcImZ1dHVyZVwiLCBcImJvbmRcIl07XG4gICAgdmFsdWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHRpY2tlclR5cGU6IHN0cmluZykge1xuICAgICAgICB0aWNrZXJUeXBlID0gdGlja2VyVHlwZS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgICAgICAgaWYgKHRoaXMuaXNWYWxpZFR5cGUodGlja2VyVHlwZSkpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aWNrZXJUeXBlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0aWNrZXJUeXBlOiBcIiArIHRpY2tlclR5cGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHR0IC0gVGlja2VyVHlwZSBhcyBhIHN0cmluZ1xuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIHN0cmluZyBpcyB3aXRoaW5cbiAgICAgKiB0aGUgVkFMSURfVFlQRVMgbGlzdCwgZmFsc2Ugb3RoZXJ3aXNlXG4gICAgICovXG4gICAgaXNWYWxpZFR5cGUodHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5WQUxJRF9UWVBFUy5pbmNsdWRlcyh0dCk7XG4gICAgfVxuXG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgfVxuXG4gICAgZXF1YWxzKHRoYXQ6IFRpY2tlclR5cGUpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IHRoYXQudmFsdWU7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFV0aWxzIHtcbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGxhcmdlIGNodW5rcyBvZiB3aGl0ZXNwYWNlIGZyb20gYSBnaXZlbiBzdHJpbmcsXG4gICAgICogcmVwbGFjaW5nIGVhY2ggd2l0aCBqdXN0IGEgc2luZ2xlIHNwYWNlLlxuICAgICAqIEBwYXJhbSBzdHIgLSB0ZXh0IHdoaWNoIGNvbnRhaW5zIGV4Y2VzcyB3aGl0ZXNwYWNlXG4gICAgICogQHJldHVybnMgc3RyaW5nIHdpdGggZXhjZXNzIHdoaXRlc3BhY2UgcmVtb3ZlZFxuICAgICAqL1xuICAgIHJlbW92ZUV4dHJhV2hpdGVzcGFjZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCByZWdleCA9IG5ldyBSZWdFeHAoXCJcXFxccytcIik7XG4gICAgICAgIGxldCBzcGxpdCA9IHN0ci5zcGxpdChyZWdleCk7XG4gICAgICAgIGxldCBmdWxsID0gXCJcIjtcbiAgICAgICAgc3BsaXQuZm9yRWFjaChmdW5jdGlvbiAod29yZCkge1xuICAgICAgICAgICAgZnVsbCA9IGZ1bGwgKyB3b3JkLnRyaW0oKSArIFwiIFwiO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gR2V0IHJpZCBvZiB0aGUgb25lIGV4dHJhIHNwYWNlIGF0IHRoZSBlbmQgYmVmb3JlIHdlIHJldHVyblxuICAgICAgICByZXR1cm4gZnVsbC50cmltKCk7XG4gICAgfVxufVxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyBZYWhvb0ZpbmFuY2UgfSBmcm9tIFwiLi4vc2l0ZXMvWWFob29GaW5hbmNlXCI7XG5pbXBvcnQgeyBUaWNrZXJUeXBlIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyVHlwZVwiO1xuaW1wb3J0IHsgVGlja2VyIH0gZnJvbSBcIi4uL3RpY2tlcnMvVGlja2VyXCI7XG5pbXBvcnQgeyBSb2Jpbmhvb2QgfSBmcm9tIFwiLi4vc2l0ZXMvUm9iaW5ob29kXCI7XG5pbXBvcnQgeyBTaXRlIH0gZnJvbSBcIi4uL3NpdGVzL1NpdGVcIjtcblxuLy8gQ2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIG9uIHRoZSBicm93c2VyIGFjdGlvbi5cbmNocm9tZS5hY3Rpb24ub25DbGlja2VkLmFkZExpc3RlbmVyKGZ1bmN0aW9uIGluamVjdCh0YWIpIHtcbiAgICBjaHJvbWUudGFicy5xdWVyeShcbiAgICAgICAge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgbGFzdEZvY3VzZWRXaW5kb3c6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uICh0YWJzKSB7XG4gICAgICAgICAgICB2YXIgYWN0aXZlVGFiID0gdGFic1swXTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGFjdGl2ZVRhYi5pbmRleDtcbiAgICAgICAgICAgIGNocm9tZS50YWJzLnNlbmRNZXNzYWdlKGFjdGl2ZVRhYi5pZCwge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiY2xpY2tlZF9icm93c2VyX2FjdGlvblwiLFxuICAgICAgICAgICAgICAgIHVybDogdGFiLnVybCxcbiAgICAgICAgICAgICAgICBpbmRleDogaW5kZXggKyAxLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICApO1xufSk7XG5cbi8vIE9wZW4gbmV3IHRhYlxuY2hyb21lLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyKGZ1bmN0aW9uIG9wZW5OZXdUYWIoXG4gICAgcmVxdWVzdCxcbiAgICBzZW5kZXIsXG4gICAgc2VuZFJlc3BvbnNlXG4pIHtcbiAgICBpZiAocmVxdWVzdC5tZXNzYWdlID09PSBcIm9wZW5fbmV3X3RhYlwiKSB7XG4gICAgICAgIGxldCB0b1NpdGUgPSBkZXRlcm1pbmVTaXRlKHJlcXVlc3QudG9TaXRlKTtcblxuICAgICAgICBsZXQgbmV3VGlja2VyID0gbmV3IFRpY2tlcihcbiAgICAgICAgICAgIHJlcXVlc3QudGlja2VyU3ltYm9sLFxuICAgICAgICAgICAgcmVxdWVzdC50aWNrZXJOYW1lLFxuICAgICAgICAgICAgbmV3IFRpY2tlclR5cGUocmVxdWVzdC50aWNrZXJUeXBlKVxuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZyhcInNlcnZpY2VXb3JrZXIgdGlja2VyOiBcIiArIG5ld1RpY2tlci50b1N0cmluZygpKTtcblxuICAgICAgICBsZXQgdXJsID0gdG9TaXRlLmNyZWF0ZVVybEZvclRpY2tlcihuZXdUaWNrZXIpO1xuICAgICAgICBjaHJvbWUudGFicy5jcmVhdGUoe1xuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBpbmRleDogcmVxdWVzdC5pbmRleCxcbiAgICAgICAgfSk7XG4gICAgfVxufSk7XG5cbmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbiBvcGVuSG9tZXBhZ2UoXG4gICAgcmVxdWVzdCxcbiAgICBzZW5kZXIsXG4gICAgc2VuZFJlc3BvbnNlXG4pIHtcbiAgICBpZiAocmVxdWVzdC5tZXNzYWdlID09PSBcIm9wZW5faG9tZXBhZ2VcIikge1xuICAgICAgICBsZXQgdG9TaXRlID0gZGV0ZXJtaW5lU2l0ZShyZXF1ZXN0LnRvU2l0ZSk7XG5cbiAgICAgICAgbGV0IHVybCA9IHRvU2l0ZS5iYXNlVXJsO1xuICAgICAgICBjb25zb2xlLmxvZyhcInNlcnZpY2VXb3JrZXIgb3Blbl9ob21lcGFnZSB1cmw6IFwiICsgdXJsKTtcblxuICAgICAgICBjaHJvbWUudGFicy5jcmVhdGUoe1xuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBpbmRleDogcmVxdWVzdC5pbmRleCxcbiAgICAgICAgfSk7XG4gICAgfVxufSk7XG5cbmZ1bmN0aW9uIGRldGVybWluZVNpdGUoc2l0ZTogc3RyaW5nKTogU2l0ZSB7XG4gICAgY29uc29sZS5sb2coXCJkZXRlcm1pbmVTaXRlKHNpdGUpOiBcIiArIHNpdGUpO1xuICAgIHNpdGUgPSBzaXRlLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKHNpdGUuaW5jbHVkZXMoXCJyb2Jpbmhvb2RcIikpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSb2Jpbmhvb2QoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IFlhaG9vRmluYW5jZSgpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVVcmxGb3JUaWNrZXIiLCJ0aWNrZXIiLCJ0aWNrZXJUeXBlIiwidmFsdWUiLCJ0aGlzIiwiYmFzZVVybCIsInN5bWJvbCIsImdldFRpY2tlciIsInVybCIsImRvY3VtZW50IiwiZ2V0VGlja2VyRnJvbVVybCIsImdldE5hbWUiLCJnZXRUaWNrZXJUeXBlIiwic3BsaXRBcnJheSIsInNwbGl0IiwibGFzdEluZGV4IiwibGVuZ3RoIiwidHJpbSIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImlzQ3J5cHRvIiwiaW5jbHVkZXMiLCJpc0V0ZiIsImlzTm9SZXN1bHRzUGFnZSIsImlzVGlja2VyVXJsIiwibmFtZSIsIkVYQ0VQVElPTl9USUNLRVJTIiwiTWFwIiwiaXMiLCJzaXRlIiwiY3J5cHRvQXJnIiwieCIsInNldCIsInMiLCJjb252ZXJ0UGVyaW9kVG9IeXBoZW4iLCJjaGVja0V4Y2VwdGlvbkxpc3QiLCJ0b1N0cmluZyIsInRpY2tlclN0cmluZyIsImdldFRpY2tlckZyb21QYWdlIiwidGlja2VyU3RyIiwidHRTdHIiLCJpc091dGdvaW5nIiwiYXJnQXJyYXkiLCJleGNlcHRpb25JdGVyYXRvciIsImVudHJpZXMiLCJwYWlyIiwia2V5QXJyYXkiLCJ2YWxBcnJheSIsImdldFF1b3RlSGVhZGVySW5mb0lkIiwibmFtZVdpdGhUaWNrZXJSZW1vdmVkIiwiZ2V0Q29tcGFueUhlYWRlciIsInJlbW92ZUV4dHJhV2hpdGVzcGFjZSIsImNsZWFuZWRVcFN5bWJvbCIsInF1b3RlU3VtbWFyeSIsImdldEVsZW1lbnRCeUlkIiwic3RhcnRzV2l0aCIsImNvbnZlcnRIeXBoZW5Ub1BlcmlvZCIsInV0aWxzIiwicmVwbGFjZSIsImVxdWFscyIsInRoYXQiLCJuYW1lRXF1YWxzIiwidGhhdE5hbWUiLCJ0aGlzTmFtZSIsInRvTG93ZXJDYXNlIiwiVkFMSURfVFlQRVMiLCJpc1ZhbGlkVHlwZSIsIkVycm9yIiwidHQiLCJzdHIiLCJyZWdleCIsIlJlZ0V4cCIsImZ1bGwiLCJmb3JFYWNoIiwid29yZCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRldGVybWluZVNpdGUiLCJjb25zb2xlIiwibG9nIiwiY2hyb21lIiwiYWN0aW9uIiwib25DbGlja2VkIiwiYWRkTGlzdGVuZXIiLCJ0YWIiLCJ0YWJzIiwicXVlcnkiLCJhY3RpdmUiLCJsYXN0Rm9jdXNlZFdpbmRvdyIsImFjdGl2ZVRhYiIsImluZGV4Iiwic2VuZE1lc3NhZ2UiLCJpZCIsIm1lc3NhZ2UiLCJydW50aW1lIiwib25NZXNzYWdlIiwicmVxdWVzdCIsInNlbmRlciIsInNlbmRSZXNwb25zZSIsInRvU2l0ZSIsIm5ld1RpY2tlciIsInRpY2tlclN5bWJvbCIsInRpY2tlck5hbWUiLCJjcmVhdGUiXSwic291cmNlUm9vdCI6IiJ9